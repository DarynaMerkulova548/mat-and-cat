<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–∞—Ç–µ–ú–∞–≥—ñ—è - –ó–∞—Å—Ç–æ—Å—É–Ω–æ–∫ –¥–ª—è –≤–∏–≤—á–µ–Ω–Ω—è —Ç–∞–±–ª–∏—á–∫–∏ –º–Ω–æ–∂–µ–Ω–Ω—è</title>
    <style>
        :root {
            --bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --bg-color: #ffffff;
            --text-color: #ffffff;
            --section-bg: rgba(255, 255, 255, 0.1);
            --card-bg: rgba(255, 255, 255, 0.2);
            --shadow-color: rgba(0, 0, 0, 0.2);
            --primary-color: #4facfe;
            --secondary-color: #ff6b6b;
            --success-color: #56ab2f;
            --accent-color: #764ba2;
            --dot-color: #4facfe;
            --input-bg: rgba(255, 255, 255, 0.9);
            --input-text: #333;
            --border-color: rgba(255, 255, 255, 0.5);
            --table-text: #333;
            --card-front: #5D5CDE;
            --card-back: #ffffff;
            --cat-color-1: #E27B58;
            --cat-color-2: #F9C46B;
            --cat-color-3: #94D1BE;
            --cat-theme-primary: #FF9D7A;
            --cat-theme-secondary: #FFD166;
            --cat-fur: #FFA36D;
            --cat-ear: #E27B58;
            --cat-eye: #333333;
            --cat-nose: #FF7D6B;
            --cat-whiskers: #FFFFFF;
            --bubble-bg: rgba(255, 255, 255, 0.95);
            --bubble-text: #333333;
        }
        
        .dark-theme {
            --bg-gradient: linear-gradient(135deg, #434343 0%, #000000 100%);
            --bg-color: #181818;
            --text-color: #f5f5f5;
            --section-bg: rgba(30, 30, 30, 0.6);
            --card-bg: rgba(40, 40, 40, 0.5);
            --shadow-color: rgba(0, 0, 0, 0.5);
            --primary-color: #5D5CDE;
            --secondary-color: #e74c3c;
            --success-color: #2ecc71;
            --accent-color: #9b59b6;
            --dot-color: #5D5CDE;
            --input-bg: rgba(60, 60, 60, 0.9);
            --input-text: #f5f5f5;
            --border-color: rgba(100, 100, 100, 0.5);
            --table-text: #f5f5f5;
            --card-front: #333;
            --card-back: #222;
            --cat-color-1: #D24E16;
            --cat-color-2: #F0B541;
            --cat-color-3: #62A597;
            --cat-theme-primary: #D24E16;
            --cat-theme-secondary: #F0B541;
            --cat-fur: #E27B58;
            --cat-ear: #C2613F;
            --cat-eye: #FFCC00;
            --cat-nose: #FF6B56;
            --cat-whiskers: #DDDDDD;
            --bubble-bg: rgba(50, 50, 50, 0.95);
            --bubble-text: #f5f5f5;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-gradient);
            min-height: 100vh;
            color: var(--text-color);
            transition: all 0.3s ease;
        }
        
        body.cat-theme {
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50' width='50px' height='50px' fill='%239C92AC' opacity='0.1'%3E%3Cpath d='M 10 0 C 7 0 5 2 5 5 C 5 8 7 10 10 10 C 13 10 15 8 15 5 C 15 2 13 0 10 0 z M 40 0 C 37 0 35 2 35 5 C 35 8 37 10 40 10 C 43 10 45 8 45 5 C 45 2 43 0 40 0 z M 7 23 C 3 26 0 31 0 36 C 0 40 3 43 6 43 C 9 43 12 40 12 36 C 13 39 15 41 18 41 C 21 41 24 39 25 36 C 26 39 29 41 32 41 C 35 41 37 39 38 36 C 38 40 41 43 44 43 C 47 43 50 40 50 36 C 50 31 47 26 43 23 L 43 25 C 43 30 40 34 38 34 C 36 34 35 33 35 31 C 35 29 36 27 36 24 C 36 19 33 14 25 14 C 17 14 14 19 14 24 C 14 27 14 29 14 31 C 14 33 13 34 11 34 C 9 34 7 30 7 25 z'/%3E%3C/svg%3E"),
                       linear-gradient(135deg, var(--cat-color-1) 0%, var(--cat-color-3) 100%);
        }
        
        .cat-theme .primary-gradient {
            background: linear-gradient(45deg, var(--cat-theme-primary), var(--cat-theme-secondary)) !important;
        }
        
        .cat-theme .btn-primary {
            background: linear-gradient(45deg, var(--cat-theme-primary), var(--cat-theme-secondary)) !important;
        }
        
        .cat-theme .success-gradient {
            background: linear-gradient(45deg, var(--cat-color-3), var(--cat-color-2)) !important;
        }
        
        .cat-theme .btn-success {
            background: linear-gradient(45deg, var(--cat-color-3), var(--cat-color-2)) !important;
        }
        
        .cat-footprint {
            display: inline-block;
            font-size: 1.2em;
            margin: 0 3px;
            transform: rotate(10deg);
        }

        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* –°—Ç–∏–ª—ñ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó */
        .auth-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .auth-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .auth-container {
            background: var(--section-bg);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 40px;
            max-width: 400px;
            width: 90%;
            color: var(--text-color);
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }

        .auth-modal.active .auth-container {
            transform: scale(1);
        }

        .auth-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .auth-header h2 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .form-group label {
            font-weight: 600;
            color: var(--text-color);
        }

        .form-input {
            padding: 15px;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            font-size: 1.1em;
            background: var(--input-bg);
            color: var(--input-text);
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .auth-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .auth-btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .auth-btn.primary {
            background: linear-gradient(45deg, var(--primary-color), var(--accent-color));
            color: white;
        }

        .auth-btn.secondary {
            background: var(--card-bg);
            color: var(--text-color);
        }

        .auth-btn:hover {
            transform: translateY(-2px);
        }

        .auth-switch {
            text-align: center;
            margin-top: 20px;
            cursor: pointer;
            color: var(--primary-color);
        }

        .user-info {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            padding: 10px 20px;
            border-radius: 50px;
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 100;
        }

        .user-avatar {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .logout-btn {
            background: var(--secondary-color);
            border: none;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .cat-title {
            margin-left: 5px;
            font-size: 0.8em;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .themes-bar {
            margin-top: 15px;
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .theme-button {
            background: var(--card-bg);
            border: none;
            border-radius: 50px;
            padding: 8px 15px;
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: bold;
        }
        
        .theme-button:hover, .theme-button.active {
            background: var(--primary-color);
            transform: translateY(-2px);
        }

        .theme-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
            margin-top: 15px;
        }

        .theme-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .theme-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--section-bg);
            transition: .4s;
            border-radius: 30px;
        }

        .theme-slider:before {
            position: absolute;
            content: "‚òÄÔ∏è";
            height: 24px;
            width: 24px;
            left: 4px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        input:checked + .theme-slider {
            background-color: var(--primary-color);
        }

        input:checked + .theme-slider:before {
            transform: translateX(28px);
            content: "üåô";
            background-color: #333;
        }

        .features-bar {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .feature-toggle {
            display: flex;
            align-items: center;
            background: var(--card-bg);
            padding: 8px 15px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .feature-toggle:hover {
            background: var(--primary-color);
        }

        .feature-toggle input {
            margin-right: 8px;
        }

        .feature-toggle label {
            font-size: 0.9em;
            cursor: pointer;
        }

        .main-nav {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .nav-btn {
            padding: 15px 25px;
            border: none;
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--card-bg);
            color: var(--text-color);
            backdrop-filter: blur(10px);
            min-width: 150px;
        }

        .nav-btn:hover, .nav-btn.active {
            background: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px var(--shadow-color);
        }

        .section {
            display: none;
            background: var(--section-bg);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px var(--shadow-color);
            margin-bottom: 80px; /* –î–æ–¥–∞—î–º–æ –≤—ñ–¥—Å—Ç—É–ø –≤–Ω–∏–∑—É –¥–ª—è –∫–æ—Ç–∏–∫–∞ */
        }

        .section.active {
            display: block;
        }

        /* –†–æ–∑–¥—ñ–ª –Ω–∞–≤—á–∞–Ω–Ω—è */
        .learning-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .table-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .table-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px var(--shadow-color);
            background: var(--primary-color);
        }

        .table-card h3 {
            font-size: 1.5em;
            margin-bottom: 15px;
        }

        .multiplication-table {
            background: var(--input-bg);
            color: var(--table-text);
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
        }

        .table-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            font-size: 1.1em;
        }

        .table-row:last-child {
            border-bottom: none;
        }

        .equation {
            font-weight: 600;
        }

        .result {
            font-weight: bold;
            color: var(--primary-color);
        }

        /* –†–æ–∑–¥—ñ–ª —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è */
        .training-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
            background: var(--card-bg);
            padding: 10px 15px;
            border-radius: 10px;
        }

        .control-group label {
            font-weight: 600;
        }

        .control-group select, .control-group input {
            padding: 8px 12px;
            border: none;
            border-radius: 6px;
            font-size: 1em;
            background: var(--input-bg);
            color: var(--input-text);
        }

        .training-area {
            text-align: center;
            display: none;
        }

        .training-area.active {
            display: block;
        }

        .problem {
            font-size: 3em;
            margin: 30px 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .input-area {
            margin: 30px 0;
        }

        .answer-input {
            font-size: 2em;
            padding: 15px 20px;
            border: 3px solid var(--border-color);
            border-radius: 12px;
            text-align: center;
            width: 150px;
            background: var(--input-bg);
            color: var(--input-text);
        }

        .answer-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 20px rgba(79, 172, 254, 0.3);
        }

        .feedback {
            font-size: 1.5em;
            margin: 20px 0;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .feedback.correct {
            color: var(--success-color);
            animation: bounce 0.6s ease;
        }

        .feedback.incorrect {
            color: var(--secondary-color);
            animation: shake 0.5s ease;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 25px;
            border: none;
            border-radius: 15px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 160px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(45deg, var(--primary-color), var(--accent-color));
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(45deg, var(--secondary-color), #ee5a52);
            color: white;
        }

        .btn-success {
            background: linear-gradient(45deg, var(--success-color), #a8e6cf);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px var(--shadow-color);
        }

        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .progress-section {
            margin-top: 30px;
        }

        .progress-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--card-bg);
            margin-bottom: 15px;
            padding: 15px 20px;
            border-radius: 10px;
        }

        .progress-bar {
            width: 200px;
            height: 10px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, var(--success-color), #a8e6cf);
            transition: width 0.3s ease;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ñ—Å—Ç—å */
        @media (max-width: 768px) {
            .app-container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .problem {
                font-size: 2em;
            }
            
            .answer-input {
                font-size: 1.5em;
                width: 120px;
            }
            
            .learning-grid {
                grid-template-columns: 1fr;
            }
            
            .btn {
                width: 100%;
                margin-bottom: 10px;
                font-size: 1.4em;
                padding: 20px 25px;
            }
            
            .nav-btn {
                width: 100%;
                font-size: 1.3em;
                padding: 20px 25px;
            }
            
            .control-group {
                width: 100%;
            }
            
            .control-group select, .control-group input {
                font-size: 1.2em;
                padding: 12px 16px;
            }
            
            .memory-board {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .cat-bubble {
                max-width: 200px;
                left: auto;
                right: 90px;
                bottom: 90px;
            }

            .user-info {
                position: relative;
                top: auto;
                right: auto;
                margin-bottom: 20px;
                justify-content: center;
            }
        }

        .hint-section {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }

        .visual-aid {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }

        .dot-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 5px;
        }

        .dots {
            display: grid;
            gap: 5px;
            margin-bottom: 10px;
        }

        .dot {
            width: 15px;
            height: 15px;
            background: var(--dot-color);
            border-radius: 50%;
            animation: fadeIn 0.3s ease;
        }
        
        .cat-dots .dot {
            width: 16px;
            height: 10px;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            position: relative;
        }
        
        .cat-dots .dot::before,
        .cat-dots .dot::after {
            content: '';
            position: absolute;
            background: var(--dot-color);
            width: 8px;
            height: 8px;
            border-radius: 50%;
            top: -4px;
        }
        
        .cat-dots .dot::before {
            left: 0;
        }
        
        .cat-dots .dot::after {
            right: 0;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0); }
            to { opacity: 1; transform: scale(1); }
        }

        /* –°—Ç–∏–ª—ñ –¥–ª—è —ñ–≥–æ—Ä */
        .game-container {
            display: none;
            text-align: center;
        }

        .game-container.active {
            display: block;
        }

        .game-title {
            font-size: 1.8em;
            margin-bottom: 20px;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
        }

        .game-description {
            margin-bottom: 25px;
            font-size: 1.1em;
        }

        .game-area {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            min-height: 300px;
            position: relative;
        }

        .catch-game-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        @media (min-width: 768px) {
            .catch-game-options {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        .answer-option {
            background: var(--card-bg);
            border: none;
            padding: 20px;
            border-radius: 15px;
            font-size: 1.5em;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-color);
            font-weight: bold;
            min-height: 80px;
        }

        .answer-option:hover {
            transform: translateY(-5px);
            background: var(--primary-color);
        }

        .game-score {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--primary-color);
            color: white;
            padding: 10px 15px;
            border-radius: 50px;
            font-weight: bold;
        }

        .game-timer {
            position: absolute;
            top: 15px;
            left: 15px;
            background: var(--card-bg);
            color: var(--text-color);
            padding: 10px 15px;
            border-radius: 50px;
            font-weight: bold;
        }

        /* –°—Ç–∏–ª—ñ –¥–ª—è –Ω–∞–≥–æ—Ä–æ–¥ */
        .achievements-section {
            margin-top: 40px;
        }

        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .achievement-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .achievement-card.unlocked {
            background: linear-gradient(45deg, var(--success-color), var(--primary-color));
        }

        .achievement-card.locked {
            filter: grayscale(1);
            opacity: 0.7;
        }

        .achievement-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .achievement-title {
            font-size: 1em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .achievement-description {
            font-size: 0.8em;
            opacity: 0.8;
        }

        /* –°—Ç–∏–ª—ñ –¥–ª—è –º—ñ–Ω—ñ—ñ–≥–æ—Ä –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó */
        .games-nav {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .game-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--card-bg);
            color: var(--text-color);
        }

        .game-btn:hover, .game-btn.active {
            background: var(--primary-color);
        }

        /* –ê–Ω—ñ–º–∞—Ü—ñ—è –¥–ª—è —Ä–æ–∑–±–ª–æ–∫—É–≤–∞–Ω–Ω—è –Ω–∞–≥–æ—Ä–æ–¥ */
        @keyframes unlock {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .achievement-unlocked {
            animation: unlock 0.8s ease-in-out;
        }
        
        .read-button {
            background: var(--primary-color);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: white;
            font-size: 1.2em;
            margin-left: 15px;
            transition: all 0.3s ease;
        }
        
        .read-button:hover {
            background: var(--accent-color);
            transform: scale(1.1);
        }
        
        .problem-container {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* –ê–Ω—ñ–º–∞—Ü—ñ—è –¥–ª—è –∫–Ω–æ–ø–∫–∏ —á–∏—Ç–∞–Ω–Ω—è */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .read-button.speaking {
            animation: pulse 1.5s infinite;
            background: var(--secondary-color);
        }
        
        /* –°—Ç–∏–ª—ñ –¥–ª—è –≥—Ä–∏ "–ü–∞—Ä–Ω—ñ –∫–∞—Ä—Ç–∫–∏" */
        .memory-game-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .memory-board {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            perspective: 1000px;
        }
        
        @media (min-width: 768px) {
            .memory-board {
                grid-template-columns: repeat(4, 1fr);
            }
        }
        
        .memory-card {
            height: 100px;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.5s;
            cursor: pointer;
        }
        
        @media (max-width: 768px) {
            .memory-card {
                height: 80px;
            }
        }
        
        .memory-card.flipped {
            transform: rotateY(180deg);
        }
        
        .memory-card.matched {
            transform: rotateY(180deg);
            opacity: 0.7;
        }
        
        .memory-card-front, .memory-card-back {
            width: 100%;
            height: 100%;
            padding: 10px;
            position: absolute;
            backface-visibility: hidden;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            font-weight: bold;
        }
        
        .memory-card-front {
            background-color: var(--card-front);
            color: white;
            transform: rotateY(180deg);
            font-size: 1.4em;
        }
        
        .memory-card-back {
            background-color: var(--card-back);
            color: var(--primary-color);
            font-size: 2em;
        }
        
        .cat-theme .memory-card-back {
            background-color: var(--card-back);
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50' width='50px' height='50px' fill='%23E27B58' opacity='0.2'%3E%3Cpath d='M 10 0 C 7 0 5 2 5 5 C 5 8 7 10 10 10 C 13 10 15 8 15 5 C 15 2 13 0 10 0 z M 40 0 C 37 0 35 2 35 5 C 35 8 37 10 40 10 C 43 10 45 8 45 5 C 45 2 43 0 40 0 z M 7 23 C 3 26 0 31 0 36 C 0 40 3 43 6 43 C 9 43 12 40 12 36 C 13 39 15 41 18 41 C 21 41 24 39 25 36 C 26 39 29 41 32 41 C 35 41 37 39 38 36 C 38 40 41 43 44 43 C 47 43 50 40 50 36 C 50 31 47 26 43 23 L 43 25 C 43 30 40 34 38 34 C 36 34 35 33 35 31 C 35 29 36 27 36 24 C 36 19 33 14 25 14 C 17 14 14 19 14 24 C 14 27 14 29 14 31 C 14 33 13 34 11 34 C 9 34 7 30 7 25 z'/%3E%3C/svg%3E");
            background-position: center;
            background-repeat: no-repeat;
        }
        
        .memory-level-select {
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        
        .level-button {
            background: var(--card-bg);
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            color: var(--text-color);
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .level-button.active, .level-button:hover {
            background: var(--primary-color);
        }
        
        .memory-stats {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 20px;
        }
        
        .memory-stat {
            background: var(--card-bg);
            padding: 10px 20px;
            border-radius: 50px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .memory-stat-icon {
            font-size: 1.2em;
        }
        
        /* –ê–Ω—ñ–º–∞—Ü—ñ—ó –¥–ª—è –≥—Ä–∏ "–ü–∞—Ä–Ω—ñ –∫–∞—Ä—Ç–∫–∏" */
        @keyframes cardMatch {
            0% { transform: rotateY(180deg) scale(1); }
            50% { transform: rotateY(180deg) scale(1.1); }
            100% { transform: rotateY(180deg) scale(1); }
        }
        
        .memory-card.match-animation {
            animation: cardMatch 0.5s;
        }
        
        @keyframes wrongMatch {
            0%, 100% { transform: rotateY(180deg) translateX(0); }
            20%, 60% { transform: rotateY(180deg) translateX(-5px); }
            40%, 80% { transform: rotateY(180deg) translateX(5px); }
        }
        
        .memory-card.wrong-animation {
            animation: wrongMatch 0.5s;
        }
        
        /* –°—Ç–∏–ª—ñ –¥–ª—è –∫–æ—Ç—è—á–æ—ó —Ç–µ–º–∏ */
        .cat-task {
            background: linear-gradient(45deg, var(--cat-color-3), var(--cat-color-1), var(--cat-color-2));
            background-size: 200% 200%;
            animation: gradientBG 5s ease infinite;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .cat-task p {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .cat-task-icon {
            font-size: 1.5em;
            margin-right: 10px;
        }
        
        /* –°—Ç–∏–ª—ñ –¥–ª—è –∫–æ—Ç–∏–∫–∞ */
        .cat-character {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 100px;
            height: 100px;
            z-index: 100;
            cursor: pointer;
            filter: drop-shadow(0 3px 5px rgba(0,0,0,0.3));
            transition: transform 0.3s ease;
        }
        
        .cat-character:hover {
            transform: scale(1.1);
        }
        
        .cat-bounce {
            animation: catBounce 0.5s ease;
        }
        
        .cat-idle {
            animation: catIdle 10s ease-in-out infinite;
        }
        
        @keyframes catBounce {
            0% { transform: translateY(0); }
            40% { transform: translateY(-20px) rotate(-5deg); }
            50% { transform: translateY(-25px) rotate(5deg); }
            70% { transform: translateY(-15px) rotate(-3deg); }
            100% { transform: translateY(0); }
        }
        
        @keyframes catIdle {
            0%, 100% { transform: translateY(0); }
            25% { transform: translateY(-5px) rotate(-2deg); }
            50% { transform: translateY(-3px) rotate(2deg); }
            75% { transform: translateY(-6px) rotate(-1deg); }
        }
        
        .cat-bubble {
            position: fixed;
            bottom: 130px;
            right: 130px;
            background: var(--bubble-bg);
            color: var(--bubble-text);
            padding: 12px 20px;
            border-radius: 20px;
            max-width: 250px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 101;
            opacity: 0;
            transition: all 0.3s ease;
            pointer-events: none;
            font-weight: bold;
        }
        
        .cat-bubble:after {
            content: '';
            position: absolute;
            bottom: -10px;
            right: 20px;
            width: 20px;
            height: 20px;
            background: var(--bubble-bg);
            transform: rotate(45deg);
            box-shadow: 5px 5px 5px rgba(0,0,0,0.1);
        }
        
        .cat-bubble.visible {
            opacity: 1;
            transform: translateY(-10px);
        }
        
        /* –ê–Ω—ñ–º–∞—Ü—ñ—è –¥–ª—è –∫–æ—Ç—è—á–∏—Ö –≤—É—Å—ñ–≤ */
        @keyframes whiskerMove {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(1deg); }
            75% { transform: rotate(-1deg); }
        }
        
        @keyframes tailMove {
            0%, 100% { transform: rotate(0); }
            25% { transform: rotate(8deg); }
            50% { transform: rotate(0); }
            75% { transform: rotate(-8deg); }
        }
        
        .cat-reward {
            position: fixed;
            top: 20%;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(45deg, var(--cat-color-1), var(--cat-color-2));
            color: white;
            padding: 20px 30px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            z-index: 1000;
            opacity: 0;
            transition: all 0.5s ease;
            animation: catRewardAnim 0.5s ease 0.2s forwards;
            max-width: 90%;
        }
        
        @keyframes catRewardAnim {
            0% { opacity: 0; transform: translateX(-50%) scale(0.8); }
            80% { opacity: 1; transform: translateX(-50%) scale(1.05); }
            100% { opacity: 1; transform: translateX(-50%) scale(1); }
        }
        
        .cat-reward h3 {
            font-size: 1.5em;
            margin-bottom: 10px;
        }
        
        .cat-reward p {
            margin-bottom: 15px;
        }
        
        .cat-reward-icon {
            font-size: 3em;
            margin-bottom: 10px;
            display: block;
        }

        /* –ü–æ–ª—ñ–ø—à–µ–Ω–∏–π —Å—Ç–∏–ª—å –¥–ª—è –±—É–ª—å–±–∞—à–∫–∏ –≤ –≥—Ä—ñ "–ù–∞–≥–æ–¥—É–π –∫–æ—Ç–∏–∫–∞" */
        #catThoughtBubble {
            background: var(--bubble-bg) !important;
            color: var(--bubble-text) !important;
            font-weight: bold !important;
            box-shadow: 0 5px 15px rgba(0,0,0,0.25) !important;
            border: 2px solid rgba(255,255,255,0.2) !important;
        }
        
        #catThoughtBubble > div {
            color: var(--bubble-text) !important;
            font-weight: bold !important;
        }
        
        #catThoughtBubble > div:last-child {
            background: var(--bubble-bg) !important;
        }

        /* –°—Ç–∏–ª—ñ –¥–ª—è –æ–Ω–ª–∞–π–Ω —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ */
        .online-status {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9em;
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success-color);
        }

        .status-indicator.offline {
            background: var(--secondary-color);
        }

        /* –°—Ç–∏–ª—ñ –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ—ó —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
        .global-stats {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            margin-top: 30px;
        }

        .global-stats h3 {
            text-align: center;
            margin-bottom: 20px;
        }

        .global-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
    </style>
</head>
<body>
    <!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó -->
    <div id="authModal" class="auth-modal">
        <div class="auth-container">
            <div class="auth-header">
                <h2 id="authTitle">–í—Ö—ñ–¥ –¥–æ –ú–∞—Ç–µ–ú–∞–≥—ñ—ó</h2>
                <p>–ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—è –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø—Ä–æ–≥—Ä–µ—Å—É</p>
            </div>
            
            <form id="authForm" class="auth-form">
                <div class="form-group">
                    <label for="username">–Ü–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:</label>
                    <input type="text" id="username" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label for="email">Email:</label>
                    <input type="email" id="email" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label for="password">–ü–∞—Ä–æ–ª—å:</label>
                    <input type="password" id="password" class="form-input" required>
                </div>
                
                <div class="auth-buttons">
                    <button type="submit" class="auth-btn primary" id="authSubmitBtn">–£–≤—ñ–π—Ç–∏</button>
                    <button type="button" class="auth-btn secondary" onclick="closeAuthModal()">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                </div>
            </form>
            
            <div class="auth-switch">
                <p id="authSwitchText">–ù–µ–º–∞—î –∞–∫–∞—É–Ω—Ç—É? <span onclick="switchAuthMode()">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</span></p>
            </div>
        </div>
    </div>

    <!-- –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ -->
    <div id="userInfo" class="user-info" style="display: none;">
        <div class="user-avatar" id="userAvatar">–£</div>
        <span id="userName">–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á</span>
        <div class="online-status">
            <div class="status-indicator" id="statusIndicator"></div>
            <span id="statusText">–æ–Ω–ª–∞–π–Ω</span>
        </div>
        <button class="logout-btn" onclick="logout()">–í–∏—Ö—ñ–¥</button>
    </div>

    <div class="app-container">
        <div class="header">
            <h1>
                üßÆ –ú–∞—Ç–µ–ú–∞–≥—ñ—è <span class="cat-title">—ñ –ö–æ—Ç–∏–∫–∏</span>
            </h1>
            <p>–Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫ –¥–ª—è –≤–∏–≤—á–µ–Ω–Ω—è —Ç–∞–±–ª–∏—á–∫–∏ –º–Ω–æ–∂–µ–Ω–Ω—è</p>
            
            <div class="themes-bar">
                <button class="theme-button active" id="standardTheme">
                    <span>üßÆ</span> –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ —Ç–µ–º–∞
                </button>
                <button class="theme-button" id="catTheme">
                    <span>üê±</span> –ö–æ—Ç—è—á–∞ —Ç–µ–º–∞
                </button>
            </div>
            
            <label class="theme-switch">
                <input type="checkbox" id="themeToggle">
                <span class="theme-slider"></span>
            </label>
        </div>
        
        <div class="features-bar">
            <div class="feature-toggle">
                <input type="checkbox" id="speechToggle" checked>
                <label for="speechToggle">üîä –û–∑–≤—É—á–µ–Ω–Ω—è –∑–∞–≤–¥–∞–Ω—å</label>
            </div>
            <div class="feature-toggle">
                <input type="checkbox" id="animationsToggle" checked>
                <label for="animationsToggle">‚ú® –ê–Ω—ñ–º–∞—Ü—ñ—ó</label>
            </div>
            <div class="feature-toggle">
                <input type="checkbox" id="catTasksToggle" checked>
                <label for="catTasksToggle">üê± –ó–∞–≤–¥–∞–Ω–Ω—è –∑ –∫–æ—Ç–∏–∫–∞–º–∏</label>
            </div>
        </div>

        <div class="main-nav">
            <button class="nav-btn active" onclick="showSection('learning')">üìö –ù–∞–≤—á–∞–Ω–Ω—è</button>
            <button class="nav-btn" onclick="showSection('training')">üèãÔ∏è –¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è</button>
            <button class="nav-btn" onclick="showSection('games')">üéÆ –ú—ñ–Ω—ñ-—ñ–≥—Ä–∏</button>
            <button class="nav-btn" onclick="showSection('statistics')">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
        </div>

        <!-- –†–æ–∑–¥—ñ–ª –Ω–∞–≤—á–∞–Ω–Ω—è -->
        <div id="learning" class="section active">
            <h2 style="text-align: center; margin-bottom: 30px;">–í–∏–≤—á–µ–Ω–Ω—è —Ç–∞–±–ª–∏—á–∫–∏ –º–Ω–æ–∂–µ–Ω–Ω—è</h2>
            
            <div class="learning-grid">
                <div class="table-card" onclick="showTable(1)">
                    <h3>–¢–∞–±–ª–∏—Ü—è –º–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 1</h3>
                    <p>–ù–∞–π–ø—Ä–æ—Å—Ç—ñ—à–∞ —Ç–∞–±–ª–∏—Ü—è –¥–ª—è –ø–æ—á–∞—Ç–∫—É</p>
                </div>
                <div class="table-card" onclick="showTable(2)">
                    <h3>–¢–∞–±–ª–∏—Ü—è –º–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 2</h3>
                    <p>–ü–æ–¥–≤–æ—î–Ω–Ω—è —á–∏—Å–µ–ª</p>
                </div>
                <div class="table-card" onclick="showTable(3)">
                    <h3>–¢–∞–±–ª–∏—Ü—è –º–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 3</h3>
                    <p>–ü–æ—Ç—Ä–æ—î–Ω–Ω—è —á–∏—Å–µ–ª</p>
                </div>
                <div class="table-card" onclick="showTable(4)">
                    <h3>–¢–∞–±–ª–∏—Ü—è –º–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 4</h3>
                    <p>–£—á–µ—Ç–≤–µ—Ä–µ–Ω–Ω—è —á–∏—Å–µ–ª</p>
                </div>
                <div class="table-card" onclick="showTable(5)">
                    <h3>–¢–∞–±–ª–∏—Ü—è –º–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 5</h3>
                    <p>–ú–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 5 –∑–∞–≤–∂–¥–∏ –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è –Ω–∞ 0 –∞–±–æ 5</p>
                </div>
                <div class="table-card" onclick="showTable(6)">
                    <h3>–¢–∞–±–ª–∏—Ü—è –º–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 6</h3>
                    <p>–®–µ—Å—Ç–∏–∫—Ä–∞—Ç–Ω–µ –∑–±—ñ–ª—å—à–µ–Ω–Ω—è</p>
                </div>
                <div class="table-card" onclick="showTable(7)">
                    <h3>–¢–∞–±–ª–∏—Ü—è –º–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 7</h3>
                    <p>–°–µ–º–∏–∫—Ä–∞—Ç–Ω–µ –∑–±—ñ–ª—å—à–µ–Ω–Ω—è</p>
                </div>
                <div class="table-card" onclick="showTable(8)">
                    <h3>–¢–∞–±–ª–∏—Ü—è –º–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 8</h3>
                    <p>–í–æ—Å—å–º–∏–∫—Ä–∞—Ç–Ω–µ –∑–±—ñ–ª—å—à–µ–Ω–Ω—è</p>
                </div>
                <div class="table-card" onclick="showTable(9)">
                    <h3>–¢–∞–±–ª–∏—Ü—è –º–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 9</h3>
                    <p>–î–µ–≤'—è—Ç–∏–∫—Ä–∞—Ç–Ω–µ –∑–±—ñ–ª—å—à–µ–Ω–Ω—è</p>
                </div>
                <div class="table-card" onclick="showTable(10)">
                    <h3>–¢–∞–±–ª–∏—Ü—è –º–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 10</h3>
                    <p>–ü—Ä–æ—Å—Ç–æ –¥–æ–¥–∞–π –Ω—É–ª—å!</p>
                </div>
            </div>

            <div id="tableDisplay" style="display: none;">
                <h3 id="tableTitle" style="text-align: center; margin-bottom: 20px;"></h3>
                <div id="tableContent" class="multiplication-table"></div>
                
                <div class="hint-section">
                    <h4>üí° –ü—ñ–¥–∫–∞–∑–∫–∏ —Ç–∞ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è</h4>
                    <div id="tableHints"></div>
                    <div id="visualAid" class="visual-aid"></div>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="startTableTraining()">
                        <span>üöÄ</span> –ü–æ—á–∞—Ç–∏ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è
                    </button>
                    <button class="btn btn-secondary" onclick="hideTable()">
                        <span>‚Ü©Ô∏è</span> –ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –Ω–∞–∑–∞–¥
                    </button>
                </div>
            </div>
        </div>

        <!-- –†–æ–∑–¥—ñ–ª —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è -->
        <div id="training" class="section">
            <h2 style="text-align: center; margin-bottom: 30px;">–¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è —Ç–∞–±–ª–∏—á–∫–∏ –º–Ω–æ–∂–µ–Ω–Ω—è</h2>
            
            <div id="catTask" class="cat-task" style="display: none;">
                <p><span class="cat-task-icon">üê±</span> <span id="catTaskText">–£ –∫–æ–∂–Ω–æ–≥–æ –∫–æ—Ç–∏–∫–∞ –ø–æ 4 –ª–∞–ø–∫–∏. –°–∫—ñ–ª—å–∫–∏ –ª–∞–ø–æ–∫ —É 3 –∫–æ—Ç–∏–∫—ñ–≤?</span></p>
            </div>
            
            <div class="training-controls">
                <div class="control-group">
                    <label for="tableSelect">–¢–∞–±–ª–∏—Ü—è:</label>
                    <select id="tableSelect">
                        <option value="mixed">–ó–º—ñ—à–∞–Ω–∞</option>
                        <option value="1">–ú–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 1</option>
                        <option value="2">–ú–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 2</option>
                        <option value="3">–ú–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 3</option>
                        <option value="4">–ú–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 4</option>
                        <option value="5">–ú–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 5</option>
                        <option value="6">–ú–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 6</option>
                        <option value="7">–ú–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 7</option>
                        <option value="8">–ú–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 8</option>
                        <option value="9">–ú–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 9</option>
                        <option value="10">–ú–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 10</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label for="difficultySelect">–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:</label>
                    <select id="difficultySelect">
                        <option value="easy">–õ–µ–≥–∫–∞ (1-5)</option>
                        <option value="medium">–°–µ—Ä–µ–¥–Ω—è (6-10)</option>
                        <option value="hard">–í–∞–∂–∫–∞ (1-10)</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label for="hintToggle">–ü—ñ–¥–∫–∞–∑–∫–∏:</label>
                    <input type="checkbox" id="hintToggle" checked>
                </div>
            </div>

            <div class="action-buttons" style="margin-bottom: 30px;">
                <button class="btn btn-success" onclick="startTraining()">
                    <span>üöÄ</span> –ü–æ—á–∞—Ç–∏ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è
                </button>
            </div>

            <div id="trainingArea" class="training-area">
                <div class="problem-container">
                    <div class="problem" id="problemText">2 √ó 3 = ?</div>
                    <button class="read-button" id="readProblem" title="–ü—Ä–æ—á–∏—Ç–∞—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è –≤–≥–æ–ª–æ—Å">
                        üîä
                    </button>
                </div>
                
                <div class="input-area">
                    <input type="number" id="answerInput" class="answer-input" placeholder="?" 
                           onkeypress="checkEnter(event)" min="0" max="100">
                </div>
                
                <div class="feedback" id="trainingFeedback"></div>
                
                <div id="hintArea" class="hint-section" style="display: none;">
                    <h4>üí° –ü—ñ–¥–∫–∞–∑–∫–∞</h4>
                    <div id="hintContent"></div>
                    <div id="hintVisual" class="visual-aid"></div>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="checkTrainingAnswer()">
                        <span>‚úì</span> –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏
                    </button>
                    <button class="btn btn-secondary" onclick="showHint()">
                        <span>üí°</span> –ü—ñ–¥–∫–∞–∑–∫–∞
                    </button>
                    <button class="btn btn-success" onclick="nextProblem()" style="display: none;" id="nextBtn">
                        <span>‚Üí</span> –î–∞–ª—ñ
                    </button>
                </div>
            </div>
        </div>

        <!-- –†–æ–∑–¥—ñ–ª –º—ñ–Ω—ñ-—ñ–≥–æ—Ä -->
        <div id="games" class="section">
            <h2 style="text-align: center; margin-bottom: 30px;">–ú—ñ–Ω—ñ-—ñ–≥—Ä–∏</h2>
            
            <div class="games-nav">
                <button class="game-btn active" onclick="showGame('catchGame')">üéØ –õ–æ–≤–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å</button>
                <button class="game-btn" onclick="showGame('memoryGame')">üß† –ü–∞—Ä–Ω—ñ –∫–∞—Ä—Ç–∫–∏</button>
                <button class="game-btn" onclick="showGame('catGame')">üê± –ù–∞–≥–æ–¥—É–π –∫–æ—Ç–∏–∫–∞</button>
            </div>
            
            <!-- –ì—Ä–∞ "–õ–æ–≤–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å" -->
            <div id="catchGame" class="game-container active">
                <h3 class="game-title">–õ–æ–≤–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å</h3>
                <p class="game-description">–û–±–µ—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ –ø—Ä–∏–∫–ª–∞–¥ —Å–µ—Ä–µ–¥ –¥–µ–∫—ñ–ª—å–∫–æ—Ö –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤. –ë—É–¥—å —à–≤–∏–¥–∫–∏–º!</p>
                
                <div class="game-area">
                    <div class="game-timer" id="catchGameTimer">30—Å</div>
                    <div class="game-score" id="catchGameScore">–†–∞—Ö—É–Ω–æ–∫: 0</div>
                    
                    <div class="problem" id="catchGameProblem">6 √ó 7 = ?</div>
                    
                    <div class="catch-game-options" id="catchGameOptions">
                        <button class="answer-option">35</button>
                        <button class="answer-option">42</button>
                        <button class="answer-option">48</button>
                        <button class="answer-option">36</button>
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="startCatchGame()">
                        <span>üéÆ</span> –ü–æ—á–∞—Ç–∏ –≥—Ä—É
                    </button>
                </div>
            </div>
            
            <!-- –ì—Ä–∞ "–ü–∞—Ä–Ω—ñ –∫–∞—Ä—Ç–∫–∏" -->
            <div id="memoryGame" class="game-container">
                <h3 class="game-title">–ü–∞—Ä–Ω—ñ –∫–∞—Ä—Ç–∫–∏</h3>
                <p class="game-description">–ó–Ω–∞–π–¥–∏ –ø–∞—Ä–∏ –ø—Ä–∏–∫–ª–∞–¥—ñ–≤ —ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π. –¢—Ä–µ–Ω—É–π –ø–∞–º'—è—Ç—å —ñ –∑–Ω–∞–Ω–Ω—è —Ç–∞–±–ª–∏—á–∫–∏ –º–Ω–æ–∂–µ–Ω–Ω—è!</p>
                
                <div class="memory-level-select">
                    <button class="level-button active" data-level="easy" onclick="setMemoryGameLevel('easy')">–õ–µ–≥–∫–∏–π (2√ó3)</button>
                    <button class="level-button" data-level="medium" onclick="setMemoryGameLevel('medium')">–°–µ—Ä–µ–¥–Ω—ñ–π (3√ó4)</button>
                    <button class="level-button" data-level="hard" onclick="setMemoryGameLevel('hard')">–°–∫–ª–∞–¥–Ω–∏–π (4√ó4)</button>
                </div>
                
                <div class="game-area">
                    <div class="game-timer" id="memoryGameTimer">60—Å</div>
                    <div class="game-score" id="memoryGameScore">–ü–∞—Ä–∏: 0/6</div>
                    
                    <div class="memory-board" id="memoryBoard">
                        <!-- –ö–∞—Ä—Ç–∫–∏ –±—É–¥—É—Ç—å –¥–æ–¥–∞–Ω—ñ –¥–∏–Ω–∞–º—ñ—á–Ω–æ —á–µ—Ä–µ–∑ JavaScript -->
                    </div>
                    
                    <div class="memory-stats">
                        <div class="memory-stat">
                            <span class="memory-stat-icon">üîÑ</span>
                            <span id="memoryMoves">–•–æ–¥–∏: 0</span>
                        </div>
                        <div class="memory-stat">
                            <span class="memory-stat-icon">‚≠ê</span>
                            <span id="memoryMatches">–ü–∞—Ä–∏: 0</span>
                        </div>
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="startMemoryGame()">
                        <span>üéÆ</span> –ü–æ—á–∞—Ç–∏ –≥—Ä—É
                    </button>
                </div>
            </div>
            
            <!-- –ì—Ä–∞ "–ù–∞–≥–æ–¥—É–π –∫–æ—Ç–∏–∫–∞" -->
            <div id="catGame" class="game-container">
                <h3 class="game-title">–ù–∞–≥–æ–¥—É–π –∫–æ—Ç–∏–∫–∞</h3>
                <p class="game-description">–†–æ–∑–≤'—è–∑—É–π –ø—Ä–∏–∫–ª–∞–¥–∏ –Ω–∞ –º–Ω–æ–∂–µ–Ω–Ω—è, —â–æ–± –Ω–∞–≥–æ–¥—É–≤–∞—Ç–∏ –≥–æ–ª–æ–¥–Ω–æ–≥–æ –∫–æ—Ç–∏–∫–∞. –ö–æ—Ç–∏–∫ –ª—é–±–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ!</p>
                
                <div class="game-area">
                    <div class="game-timer" id="catGameTimer">30—Å</div>
                    <div class="game-score" id="catGameScore">–°–º–∞–∫–æ–ª–∏–∫–∏: 0</div>
                    
                    <div style="display: flex; align-items: center; justify-content: center; height: 250px; position: relative;">
                        <div id="catGameCat" style="position: relative; text-align: center;">
                            <svg width="150" height="150" viewBox="0 0 100 100" class="cat-svg">
                                <path d="M35,60 Q50,75 65,60" stroke="#333" stroke-width="2" fill="none" />
                                <ellipse cx="30" cy="45" rx="10" ry="15" fill="#FFBB7D" />
                                <ellipse cx="70" cy="45" rx="10" ry="15" fill="#FFBB7D" />
                                <circle cx="50" cy="50" r="30" fill="#FFBB7D" />
                                <circle cx="40" cy="45" r="3" fill="#333" />
                                <circle cx="60" cy="45" r="3" fill="#333" />
                                <path d="M45,55 Q50,60 55,55" stroke="#333" stroke-width="2" fill="none" />
                                <path d="M25,30 L15,15" stroke="#FFBB7D" stroke-width="4" />
                                <path d="M75,30 L85,15" stroke="#FFBB7D" stroke-width="4" />
                                <circle cx="15" cy="15" r="5" fill="#FFBB7D" />
                                <circle cx="85" cy="15" r="5" fill="#FFBB7D" />
                            </svg>
                            <div id="catThoughtBubble" style="position: absolute; top: -80px; right: -150px; background: white; border-radius: 15px; padding: 10px; width: 150px; box-shadow: 0 3px 10px rgba(0,0,0,0.1); display: none;">
                                <div id="catThoughtText" style="margin-bottom: 5px; font-weight: bold;"></div>
                                <div style="position: absolute; bottom: -10px; left: 10px; width: 20px; height: 20px; background: white; transform: rotate(45deg); box-shadow: 3px 3px 5px rgba(0,0,0,0.1);"></div>
                            </div>
                        </div>
                        
                        <div id="catFood" style="position: absolute; bottom: 20px; right: 20px; display: none;">
                            <svg width="50" height="50" viewBox="0 0 100 100">
                                <circle cx="50" cy="50" r="40" fill="#e57373" />
                                <circle cx="30" cy="35" r="10" fill="#ef9a9a" />
                                <circle cx="70" cy="35" r="10" fill="#ef9a9a" />
                                <circle cx="30" cy="65" r="10" fill="#ef9a9a" />
                                <circle cx="70" cy="65" r="10" fill="#ef9a9a" />
                                <circle cx="50" cy="50" r="5" fill="#c62828" />
                            </svg>
                        </div>
                    </div>
                    
                    <div class="problem" id="catGameProblem">–°–∫—ñ–ª—å–∫–∏ –±—É–¥–µ 3 √ó 4?</div>
                    
                    <div class="input-area">
                        <input type="number" id="catGameInput" class="answer-input" placeholder="?" min="0" max="100">
                    </div>
                    
                    <div class="feedback" id="catGameFeedback"></div>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="startCatGame()">
                        <span>üê±</span> –ü–æ—á–∞—Ç–∏ –≥—Ä—É
                    </button>
                </div>
            </div>
        </div>

        <!-- –†–æ–∑–¥—ñ–ª —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
        <div id="statistics" class="section">
            <h2 style="text-align: center; margin-bottom: 30px;">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–∞–≤—á–∞–Ω–Ω—è</h2>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalProblems">0</div>
                    <div class="stat-label">–£—Å—å–æ–≥–æ –ø—Ä–∏–∫–ª–∞–¥—ñ–≤</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="correctAnswers">0</div>
                    <div class="stat-label">–ü—Ä–∞–≤–∏–ª—å–Ω–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="accuracy">0%</div>
                    <div class="stat-label">–¢–æ—á–Ω—ñ—Å—Ç—å</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="currentStreak">0</div>
                    <div class="stat-label">–ü–æ—Ç–æ—á–Ω–∞ —Å–µ—Ä—ñ—è</div>
                </div>
            </div>

            <div class="progress-section">
                <h3>–ü—Ä–æ–≥—Ä–µ—Å –ø–æ —Ç–∞–±–ª–∏—Ü—è—Ö –º–Ω–æ–∂–µ–Ω–Ω—è</h3>
                <div id="progressList"></div>
            </div>
            
            <!-- –°–µ–∫—Ü—ñ—è –Ω–∞–≥–æ—Ä–æ–¥ —ñ –¥–æ—Å—è–≥–Ω–µ–Ω—å -->
            <div class="achievements-section">
                <h3>–¢–≤–æ—ó –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è</h3>
                <div class="achievements-grid" id="achievementsGrid">
                    <!-- –î–æ—Å—è–≥–Ω–µ–Ω–Ω—è –¥–æ–¥–∞—é—Ç—å—Å—è –¥–∏–Ω–∞–º—ñ—á–Ω–æ —á–µ—Ä–µ–∑ JS -->
                </div>
            </div>

            <!-- –ì–ª–æ–±–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="global-stats" id="globalStats" style="display: none;">
                <h3>üåç –ì–ª–æ–±–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                <div class="global-stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="globalUsers">0</div>
                        <div class="stat-label">–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="globalProblems">0</div>
                        <div class="stat-label">–†–æ–∑–≤'—è–∑–∞–Ω–æ –ø—Ä–∏–∫–ª–∞–¥—ñ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="globalSessions">0</div>
                        <div class="stat-label">–°–µ—Å—ñ–π –Ω–∞–≤—á–∞–Ω–Ω—è</div>
                    </div>
                </div>
            </div>

            <div class="action-buttons" style="margin-top: 30px;">
                <button class="btn btn-primary" onclick="exportStats()">
                    <span>üíæ</span> –ó–±–µ—Ä–µ–≥—Ç–∏ –ø—Ä–æ–≥—Ä–µ—Å
                </button>
                <button class="btn btn-secondary" onclick="resetStats()">
                    <span>üóëÔ∏è</span> –°–∫–∏–Ω—É—Ç–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                </button>
                <button class="btn btn-success" onclick="syncWithServer()" id="syncBtn" style="display: none;">
                    <span>üîÑ</span> –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É–≤–∞—Ç–∏
                </button>
            </div>
        </div>
    </div>
    
    <!-- –ö–æ—Ç—è—á–∏–π –ø–µ—Ä—Å–æ–Ω–∞–∂ -->
    <div class="cat-character cat-idle" id="catCharacter">
        <svg viewBox="0 0 200 200" width="100%" height="100%">
            <!-- –¢—ñ–ª–æ –∫–æ—Ç–∞ -->
            <ellipse cx="100" cy="120" rx="55" ry="45" fill="var(--cat-fur)" />
            
            <!-- –õ–∞–ø–∫–∏ -->
            <ellipse cx="70" cy="155" rx="15" ry="10" fill="var(--cat-fur)" />
            <ellipse cx="130" cy="155" rx="15" ry="10" fill="var(--cat-fur)" />
            
            <!-- –ì–æ–ª–æ–≤–∞ -->
            <circle cx="100" cy="80" r="40" fill="var(--cat-fur)" />
            
            <!-- –í—É—Ö–∞ -->
            <path d="M70,60 L60,30 L85,50 Z" fill="var(--cat-ear)" />
            <path d="M130,60 L140,30 L115,50 Z" fill="var(--cat-ear)" />
            
            <!-- –í–Ω—É—Ç—Ä—ñ—à–Ω—è —á–∞—Å—Ç–∏–Ω–∞ –≤—É—Ö -->
            <path d="M70,60 L60,35 L80,50 Z" fill="#FFCCBB" />
            <path d="M130,60 L140,35 L120,50 Z" fill="#FFCCBB" />
            
            <!-- –û—á—ñ -->
            <ellipse cx="85" cy="75" rx="6" ry="9" fill="white" />
            <ellipse cx="115" cy="75" rx="6" ry="9" fill="white" />
            
            <!-- –ó—ñ–Ω–∏—Ü—ñ –∑ –∞–Ω—ñ–º–∞—Ü—ñ—î—é -->
            <circle cx="85" cy="75" r="3" fill="var(--cat-eye)">
                <animate attributeName="cy" values="73;77;73" dur="7s" repeatCount="indefinite" />
            </circle>
            <circle cx="115" cy="75" r="3" fill="var(--cat-eye)">
                <animate attributeName="cy" values="73;77;73" dur="7s" repeatCount="indefinite" />
            </circle>
            
            <!-- –ù—ñ—Å -->
            <path d="M100,85 L95,95 L105,95 Z" fill="var(--cat-nose)" />
            
            <!-- –†–æ—Ç -->
            <path d="M100,95 L100,100 M95,105 Q100,110 105,105" stroke="#333" stroke-width="2" fill="none" />
            
            <!-- –í—É—Å–∞ –∑ –∞–Ω—ñ–º–∞—Ü—ñ—î—é -->
            <g>
                <path d="M75,90 L45,85" stroke="var(--cat-whiskers)" stroke-width="1.5">
                    <animate attributeName="d" values="M75,90 L45,85;M75,90 L45,87;M75,90 L45,85" dur="5s" repeatCount="indefinite" />
                </path>
                <path d="M75,95 L40,95" stroke="var(--cat-whiskers)" stroke-width="1.5">
                    <animate attributeName="d" values="M75,95 L40,95;M75,95 L40,98;M75,95 L40,95" dur="7s" repeatCount="indefinite" />
                </path>
                <path d="M75,100 L45,105" stroke="var(--cat-whiskers)" stroke-width="1.5">
                    <animate attributeName="d" values="M75,100 L45,105;M75,100 L45,103;M75,100 L45,105" dur="6s" repeatCount="indefinite" />
                </path>
                
                <path d="M125,90 L155,85" stroke="var(--cat-whiskers)" stroke-width="1.5">
                    <animate attributeName="d" values="M125,90 L155,85;M125,90 L155,87;M125,90 L155,85" dur="5s" repeatCount="indefinite" />
                </path>
                <path d="M125,95 L160,95" stroke="var(--cat-whiskers)" stroke-width="1.5">
                    <animate attributeName="d" values="M125,95 L160,95;M125,95 L160,98;M125,95 L160,95" dur="7s" repeatCount="indefinite" />
                </path>
                <path d="M125,100 L155,105" stroke="var(--cat-whiskers)" stroke-width="1.5">
                    <animate attributeName="d" values="M125,100 L155,105;M125,100 L155,103;M125,100 L155,105" dur="6s" repeatCount="indefinite" />
                </path>
            </g>
            
            <!-- –•–≤—ñ—Å—Ç –∑ –∞–Ω—ñ–º–∞—Ü—ñ—î—é -->
            <path d="M155,120 Q180,100 185,70" stroke="var(--cat-fur)" stroke-width="12" stroke-linecap="round" fill="none">
                <animateTransform attributeName="transform" 
                             type="rotate"
                             values="0 155 120; 5 155 120; 0 155 120; -5 155 120; 0 155 120"
                             dur="8s"
                             repeatCount="indefinite"/>
            </path>
        </svg>
    </div>
    
    <div class="cat-bubble" id="catBubble">
        –ú—è—É! –ü—Ä–∏–≤—ñ—Ç! –Ø –¥–æ–ø–æ–º–æ–∂—É —Ç–æ–±—ñ –≤–∏–≤—á–∞—Ç–∏ —Ç–∞–±–ª–∏—Ü—é –º–Ω–æ–∂–µ–Ω–Ω—è!
    </div>

    <script>
        // API_URL –¥–ª—è –∑–≤'—è–∑–∫—É –∑ –±–µ–∫–µ–Ω–¥–æ–º
        const API_URL = 'http://localhost:3000/api';
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó
        let currentUser = null;
        let authToken = null;
        let isAuthMode = 'login'; // 'login' –∞–±–æ 'register'
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ
        let currentSection = 'learning';
        let currentTable = null;
        let trainingData = {
            currentProblem: null,
            tableMode: 'mixed',
            difficulty: 'medium',
            hintsEnabled: true
        };
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ –¥–ª—è —Å–∏–Ω—Ç–µ–∑—É –º–æ–≤–ª–µ–Ω–Ω—è
        let speechSynthesis = window.speechSynthesis;
        let isSpeaking = false;
        
        // –ó–º—ñ–Ω–Ω—ñ –¥–ª—è –º—ñ–Ω—ñ-—ñ–≥–æ—Ä
        let catchGameData = {
            score: 0,
            timer: 30,
            interval: null,
            currentProblem: null
        };
        
        // –ó–º—ñ–Ω–Ω—ñ –¥–ª—è –≥—Ä–∏ "–ü–∞—Ä–Ω—ñ –∫–∞—Ä—Ç–∫–∏"
        let memoryGameData = {
            cards: [],
            flippedCards: [],
            matchedPairs: 0,
            totalPairs: 0,
            moves: 0,
            timer: 60,
            interval: null,
            isLocked: false,
            level: 'easy'
        };
        
        // –ó–º—ñ–Ω–Ω—ñ –¥–ª—è –≥—Ä–∏ "–ù–∞–≥–æ–¥—É–π –∫–æ—Ç–∏–∫–∞"
        let catGameData = {
            score: 0,
            timer: 30,
            interval: null,
            currentProblem: null,
            isAnimating: false
        };
        
        // –ó–º—ñ–Ω–Ω—ñ –¥–ª—è –∫–æ—Ç—è—á–∏—Ö –∑–∞–≤–¥–∞–Ω—å
        let catTasks = [
            { text: "–£ –∫–æ–∂–Ω–æ–≥–æ –∫–æ—Ç–∏–∫–∞ –ø–æ 4 –ª–∞–ø–∫–∏. –°–∫—ñ–ª—å–∫–∏ –ª–∞–ø–æ–∫ —É 3 –∫–æ—Ç–∏–∫—ñ–≤?", a: 3, b: 4 },
            { text: "–£ –∫–æ–∂–Ω–æ–≥–æ –∫–æ—Ç–∏–∫–∞ –ø–æ 2 –≤—É—à–∫–∞. –°–∫—ñ–ª—å–∫–∏ –≤—É—à–æ–∫ —É 5 –∫–æ—Ç–∏–∫—ñ–≤?", a: 5, b: 2 },
            { text: "–ù–∞ –¥–∏–≤–∞–Ω—ñ —Å–∏–¥—è—Ç—å 6 –∫–æ—Ç—ñ–≤, —É –∫–æ–∂–Ω–æ–≥–æ –ø–æ 1 —Ö–≤–æ—Å—Ç–∏–∫—É. –°–∫—ñ–ª—å–∫–∏ –≤—Å—å–æ–≥–æ —Ö–≤–æ—Å—Ç–∏–∫—ñ–≤?", a: 6, b: 1 },
            { text: "–ö–æ—Ç–∏–∫ –∑'—ó–¥–∞—î 3 —Å–º–∞–∫–æ–ª–∏–∫–∏ –∑–∞ –¥–µ–Ω—å. –°–∫—ñ–ª—å–∫–∏ —Å–º–∞–∫–æ–ª–∏–∫—ñ–≤ –≤—ñ–Ω –∑'—ó—Å—Ç—å –∑–∞ 7 –¥–Ω—ñ–≤?", a: 7, b: 3 },
            { text: "–£ –∫–æ—Ç—è—á–æ–º—É –±—É–¥–∏–Ω–∫—É –Ω–∞ –∫–æ–∂–Ω–æ–º—É –ø–æ–≤–µ—Ä—Å—ñ –ø–æ 9 –∫–æ—Ç—ñ–≤. –°–∫—ñ–ª—å–∫–∏ –∫–æ—Ç—ñ–≤ –Ω–∞ 8 –ø–æ–≤–µ—Ä—Ö–∞—Ö?", a: 8, b: 9 },
            { text: "–ö—ñ—à–∫–∞ –ú—É—Ä–∫–∞ —Å–ø–∏—Ç—å 10 –≥–æ–¥–∏–Ω –Ω–∞ –¥–µ–Ω—å. –°–∫—ñ–ª—å–∫–∏ –≥–æ–¥–∏–Ω –≤–æ–Ω–∞ –ø—Ä–æ—Å–ø–∏—Ç—å –∑–∞ 5 –¥–Ω—ñ–≤?", a: 5, b: 10 },
            { text: "–ö–æ–∂–Ω–æ–º—É –∑ 4 –∫–æ—Ç–∏–∫—ñ–≤ –¥–∞–ª–∏ –ø–æ 2 —Å–º–∞–∫–æ–ª–∏–∫–∏. –°–∫—ñ–ª—å–∫–∏ –≤—Å—å–æ–≥–æ —Å–º–∞–∫–æ–ª–∏–∫—ñ–≤ –æ—Ç—Ä–∏–º–∞–ª–∏ –∫–æ—Ç–∏–∫–∏?", a: 4, b: 2 },
            { text: "–£ –∫–æ–∂–Ω–æ–≥–æ –∫–æ—Ç–∏–∫–∞ –ø–æ 12 –≤—É—Å–∏–∫—ñ–≤. –°–∫—ñ–ª—å–∫–∏ –≤—É—Å–∏–∫—ñ–≤ —É 4 –∫–æ—Ç–∏–∫—ñ–≤?", a: 4, b: 12 },
            { text: "–ú–∞–º–∞-–∫—ñ—à–∫–∞ –ø—Ä–∏–Ω–µ—Å–ª–∞ 7 –∫–æ—à–µ–Ω—è—Ç–∞–º –ø–æ 3 —ñ–≥—Ä–∞—à–∫–∏. –°–∫—ñ–ª—å–∫–∏ —ñ–≥—Ä–∞—à–æ–∫ –æ—Ç—Ä–∏–º–∞–ª–∏ –∫–æ—à–µ–Ω—è—Ç–∞?", a: 7, b: 3 },
            { text: "–£ 8 –∫–æ—Ç–∏–∫—ñ–≤ —Ä–∞–∑–æ–º 96 –≤—É—Å–∏–∫—ñ–≤. –°–∫—ñ–ª—å–∫–∏ –≤—É—Å–∏–∫—ñ–≤ —É –∫–æ–∂–Ω–æ–≥–æ –∫–æ—Ç–∏–∫–∞?", a: 96, b: 8 }
        ];
        
        // –ó–º—ñ–Ω–Ω—ñ –¥–ª—è –∫–æ—Ç—è—á–∏—Ö —Ä–µ–ø–ª—ñ–∫
        let catPhrases = {
            greetings: [
                "–ú—è—É! –ü—Ä–∏–≤—ñ—Ç, —è –ú—É—Ä—á–∏–∫!",
                "–ú—É—Ä—Ä—Ä, —Ä–∞–¥–∏–π —Ç–µ–±–µ –±–∞—á–∏—Ç–∏!",
                "–ú—è—É-–º—è—É! –í—á–∏–º–æ —Ç–∞–±–ª–∏—Ü—é –º–Ω–æ–∂–µ–Ω–Ω—è?",
                "–ü—Ä–∏–≤—ñ—Ç! –Ø –¥–æ–ø–æ–º–æ–∂—É —Ç–æ–±—ñ –∑ –º–∞—Ç–µ–º–∞—Ç–∏–∫–æ—é!"
            ],
            correct: [
                "–ú—É—Ä—Ä-–º—É—Ä—Ä! –ü—Ä–∞–≤–∏–ª—å–Ω–æ!",
                "–ú—è—É! –¢–∏ –º–æ–ª–æ–¥–µ—Ü—å!",
                "–ù—è–≤–Ω–æ, —Ç–∏ –¥—É–∂–µ —Ä–æ–∑—É–º–Ω–∏–π!",
                "–ú—É—Ä—Ä—Ä—Ä—Ñ–µ–∫—Ç! –ß—É–¥–æ–≤–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å!"
            ],
            incorrect: [
                "–ù—è–≤... –°–ø—Ä–æ–±—É–π —â–µ —Ä–∞–∑!",
                "–ú—è—É? –ù–µ –∑–æ–≤—Å—ñ–º —Ç–∞–∫...",
                "–ú—É—Ä—Ä... –Ø –≤—ñ—Ä—é, —â–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Ä–∞–∑—É –≤–∏–π–¥–µ!",
                "–ù—è–≤-–Ω—è–≤, —â–µ —Ç—Ä–æ—Ö–∏ –ø—Ä–∞–∫—Ç–∏–∫–∏!"
            ],
            encouragement: [
                "–¢–∏ —á—É–¥–æ–≤–æ —Å–ø—Ä–∞–≤–ª—è—î—à—Å—è!",
                "–ü—Ä–æ–¥–æ–≤–∂—É–π —É —Ç–æ–º—É –∂ –¥—É—Å—ñ!",
                "–¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è —Ä–æ–±–∏—Ç—å –∫–æ—Ç—ñ–≤... —Ç–æ–±—Ç–æ, –º–∞–π—Å—Ç—Ä—ñ–≤!",
                "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ - —Ü–µ –≤–µ—Å–µ–ª–æ! –ú—è—É!"
            ]
        };

        // –°–ø–∏—Å–æ–∫ –¥–æ—Å—è–≥–Ω–µ–Ω—å
        const achievements = [
            {
                id: 'first_correct',
                icon: 'üåü',
                title: '–ü–µ—Ä—à–∏–π —É—Å–ø—ñ—Ö',
                description: '–î–∞–π –ø–µ—Ä—à—É –ø—Ä–∞–≤–∏–ª—å–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å',
                condition: (stats) => stats.correctAnswers >= 1
            },
            {
                id: 'ten_problems',
                icon: 'üîü',
                title: '–î–µ—Å—è—Ç–æ–∫',
                description: '–†–æ–∑–≤\'—è–∂–∏ 10 –ø—Ä–∏–∫–ª–∞–¥—ñ–≤',
                condition: (stats) => stats.totalProblems >= 10
            },
            {
                id: 'perfect_5',
                icon: 'üèÜ',
                title: '–í—ñ–¥–º—ñ–Ω–Ω–∏–∫',
                description: '5 –ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π –ø—ñ–¥—Ä—è–¥',
                condition: (stats) => stats.currentStreak >= 5 || stats.bestStreak >= 5
            },
            {
                id: 'master_2',
                icon: '‚úåÔ∏è',
                title: '–ó–Ω–∞–≤–µ—Ü—å –¥–≤—ñ–π–∫–∏',
                description: '–ü–æ–≤–Ω—ñ—Å—Ç—é –≤–∏–≤—á–∏ —Ç–∞–±–ª–∏—Ü—é –Ω–∞ 2',
                condition: (stats) => stats.tableProgress['2'] && stats.tableProgress['2'].correct >= 10
            },
            {
                id: 'master_5',
                icon: 'üñêÔ∏è',
                title: '–ó–Ω–∞–≤–µ—Ü—å –ø\'—è—Ç—ñ—Ä–∫–∏',
                description: '–ü–æ–≤–Ω—ñ—Å—Ç—é –≤–∏–≤—á–∏ —Ç–∞–±–ª–∏—Ü—é –Ω–∞ 5',
                condition: (stats) => stats.tableProgress['5'] && stats.tableProgress['5'].correct >= 10
            },
            {
                id: 'master_9',
                icon: '9Ô∏è‚É£',
                title: '–ó–Ω–∞–≤–µ—Ü—å –¥–µ–≤\'—è—Ç–∫–∏',
                description: '–ü–æ–≤–Ω—ñ—Å—Ç—é –≤–∏–≤—á–∏ —Ç–∞–±–ª–∏—Ü—é –Ω–∞ 9',
                condition: (stats) => stats.tableProgress['9'] && stats.tableProgress['9'].correct >= 10
            },
            {
                id: 'catch_10',
                icon: 'üéØ',
                title: '–í–ª—É—á–Ω–∏–π —Å—Ç—Ä—ñ–ª–µ—Ü—å',
                description: '–ù–∞–±–µ—Ä–∏ 10 –æ—á–æ–∫ —É –≥—Ä—ñ "–õ–æ–≤–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å"',
                condition: (stats) => stats.gameScores && stats.gameScores.catchGame >= 10
            },
            {
                id: 'math_wizard',
                icon: 'üßô',
                title: '–ß–∞—Ä—ñ–≤–Ω–∏–∫ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏',
                description: '–î–∞–π 50 –ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π',
                condition: (stats) => stats.correctAnswers >= 50
            },
            {
                id: 'memory_master',
                icon: 'üß†',
                title: '–ú–∞–π—Å—Ç–µ—Ä –ø–∞–º\'—è—Ç—ñ',
                description: '–ü—Ä–æ–π–¥–∏ —Å–∫–ª–∞–¥–Ω–∏–π —Ä—ñ–≤–µ–Ω—å –≥—Ä–∏ "–ü–∞—Ä–Ω—ñ –∫–∞—Ä—Ç–∫–∏"',
                condition: (stats) => stats.gameScores && stats.gameScores.memoryGameHard === true
            },
            {
                id: 'memory_perfect',
                icon: 'üíØ',
                title: '–Ü–¥–µ–∞–ª—å–Ω–∞ –ø–∞–º\'—è—Ç—å',
                description: '–ó–Ω–∞–π–¥–∏ –≤—Å—ñ –ø–∞—Ä–∏ –∑–∞ –º–µ–Ω—à–µ –Ω—ñ–∂ 20 —Ö–æ–¥—ñ–≤',
                condition: (stats) => stats.gameScores && stats.gameScores.memoryGamePerfect === true
            },
            {
                id: 'cat_friend',
                icon: 'üê±',
                title: '–î—Ä—É–≥ –∫–æ—Ç–∏–∫—ñ–≤',
                description: '–†–æ–∑–≤\'—è–∂–∏ 5 –∑–∞–≤–¥–∞–Ω—å –∑ –∫–æ—Ç–∏–∫–∞–º–∏',
                condition: (stats) => stats.catTasksSolved >= 5
            },
            {
                id: 'cat_feeder',
                icon: 'üç≤',
                title: '–ì–æ–¥—É–≤–∞–ª—å–Ω–∏–∫ –∫–æ—Ç—ñ–≤',
                description: '–ù–∞–≥–æ–¥—É–π –∫–æ—Ç–∏–∫–∞ 10 —Ä–∞–∑—ñ–≤',
                condition: (stats) => stats.gameScores && stats.gameScores.catGame >= 10
            }
        ];

        // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        let stats = JSON.parse(localStorage.getItem('multiplicationStats')) || {
            totalProblems: 0,
            correctAnswers: 0,
            tableProgress: {},
            currentStreak: 0,
            bestStreak: 0,
            unlockedAchievements: [],
            catTasksSolved: 0,
            gameScores: {
                catchGame: 0,
                memoryGameEasy: false,
                memoryGameMedium: false,
                memoryGameHard: false,
                memoryGamePerfect: false,
                catGame: 0
            }
        };

        // –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è
        function showAuthModal() {
            document.getElementById('authModal').classList.add('active');
        }

        function closeAuthModal() {
            document.getElementById('authModal').classList.remove('active');
            // –û—á–∏—â–∞—î–º–æ —Ñ–æ—Ä–º—É
            document.getElementById('authForm').reset();
        }

        function switchAuthMode() {
            const authTitle = document.getElementById('authTitle');
            const authSubmitBtn = document.getElementById('authSubmitBtn');
            const authSwitchText = document.getElementById('authSwitchText');
            const emailField = document.getElementById('email').parentElement;
            
            if (isAuthMode === 'login') {
                // –ü–µ—Ä–µ–∫–ª—é—á–∞—î–º–æ—Å—è –Ω–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—é
                isAuthMode = 'register';
                authTitle.textContent = '–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –≤ –ú–∞—Ç–µ–ú–∞–≥—ñ—ó';
                authSubmitBtn.textContent = '–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è';
                authSwitchText.innerHTML = '–í–∂–µ —î –∞–∫–∞—É–Ω—Ç? <span onclick="switchAuthMode()">–£–≤—ñ–π—Ç–∏</span>';
                emailField.style.display = 'flex';
            } else {
                // –ü–µ—Ä–µ–∫–ª—é—á–∞—î–º–æ—Å—è –Ω–∞ –ª–æ–≥—ñ–Ω
                isAuthMode = 'login';
                authTitle.textContent = '–í—Ö—ñ–¥ –¥–æ –ú–∞—Ç–µ–ú–∞–≥—ñ—ó';
                authSubmitBtn.textContent = '–£–≤—ñ–π—Ç–∏';
                authSwitchText.innerHTML = '–ù–µ–º–∞—î –∞–∫–∞—É–Ω—Ç—É? <span onclick="switchAuthMode()">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</span>';
                emailField.style.display = 'none';
            }
        }

        // –û–±—Ä–æ–±–∫–∞ —Ñ–æ—Ä–º–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó
        document.getElementById('authForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            try {
                let response;
                if (isAuthMode === 'register') {
                    response = await fetch(`${API_URL}/auth/register`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ username, email, password })
                    });
                } else {
                    response = await fetch(`${API_URL}/auth/login`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ username, password })
                    });
                }
                
                const data = await response.json();
                
                if (response.ok) {
                    // –£—Å–ø—ñ—à–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è
                    currentUser = data.user;
                    authToken = data.token;
                    
                    // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —Ç–æ–∫–µ–Ω
                    localStorage.setItem('authToken', authToken);
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    
                    // –ó–∞–∫—Ä–∏–≤–∞—î–º–æ –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ
                    closeAuthModal();
                    
                    // –û–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                    updateUserInterface();
                    
                    // –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É—î–º–æ –¥–∞–Ω—ñ –∑ —Å–µ—Ä–≤–µ—Ä–æ–º
                    await syncWithServer();
                    
                    showNotification(isAuthMode === 'register' ? '–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è —É—Å–ø—ñ—à–Ω–∞!' : '–í—Ö—ñ–¥ –≤–∏–∫–æ–Ω–∞–Ω–æ!');
                } else {
                    throw new Error(data.message || '–ü–æ–º–∏–ª–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó');
                }
            } catch (error) {
                showNotification('–ü–æ–º–∏–ª–∫–∞: ' + error.message);
                console.error('Auth error:', error);
            }
        });

        function logout() {
            currentUser = null;
            authToken = null;
            localStorage.removeItem('authToken');
            localStorage.removeItem('currentUser');
            
            // –û–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            updateUserInterface();
            
            showNotification('–í–∏ –≤–∏–π—à–ª–∏ –∑ –∞–∫–∞—É–Ω—Ç—É');
        }

        function updateUserInterface() {
            const userInfo = document.getElementById('userInfo');
            const syncBtn = document.getElementById('syncBtn');
            const globalStats = document.getElementById('globalStats');
            
            if (currentUser) {
                // –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π
                userInfo.style.display = 'flex';
                document.getElementById('userName').textContent = currentUser.username;
                document.getElementById('userAvatar').textContent = currentUser.username[0].toUpperCase();
                syncBtn.style.display = 'inline-flex';
                globalStats.style.display = 'block';
                
                // –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞—Ç—É—Å –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è
                updateConnectionStatus(true);
                
                // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –≥–ª–æ–±–∞–ª—å–Ω—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                loadGlobalStats();
            } else {
                // –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π
                userInfo.style.display = 'none';
                syncBtn.style.display = 'none';
                globalStats.style.display = 'none';
                
                updateConnectionStatus(false);
            }
        }

        function updateConnectionStatus(isOnline) {
            const statusIndicator = document.getElementById('statusIndicator');
            const statusText = document.getElementById('statusText');
            
            if (isOnline) {
                statusIndicator.classList.remove('offline');
                statusText.textContent = '–æ–Ω–ª–∞–π–Ω';
            } else {
                statusIndicator.classList.add('offline');
                statusText.textContent = '–æ—Ñ–ª–∞–π–Ω';
            }
        }

        // –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –∑ —Å–µ—Ä–≤–µ—Ä–æ–º
        async function syncWithServer() {
            if (!authToken) {
                showNotification('–£–≤—ñ–π–¥—ñ—Ç—å –¥–æ –∞–∫–∞—É–Ω—Ç—É –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó');
                return;
            }
            
            try {
                // –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –ª–æ–∫–∞–ª—å–Ω—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä
                const response = await fetch(`${API_URL}/stats/sync`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify(stats)
                });
                
                if (response.ok) {
                    const data = await response.json();
                    // –û–Ω–æ–≤–ª—é—î–º–æ –ª–æ–∫–∞–ª—å–Ω—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–∞–Ω–∏–º–∏ –∑ —Å–µ—Ä–≤–µ—Ä–∞
                    stats = data.stats;
                    saveStats();
                    updateStatistics();
                    
                    showNotification('–°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!');
                } else {
                    throw new Error('–ü–æ–º–∏–ª–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó');
                }
            } catch (error) {
                showNotification('–ü–æ–º–∏–ª–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó: ' + error.message);
                console.error('Sync error:', error);
            }
        }

        // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≥–ª–æ–±–∞–ª—å–Ω–æ—ó —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        async function loadGlobalStats() {
            try {
                const response = await fetch(`${API_URL}/stats/global`);
                
                if (response.ok) {
                    const data = await response.json();
                    
                    document.getElementById('globalUsers').textContent = data.totalUsers || 0;
                    document.getElementById('globalProblems').textContent = data.totalProblems || 0;
                    document.getElementById('globalSessions').textContent = data.totalSessions || 0;
                }
            } catch (error) {
                console.error('Error loading global stats:', error);
            }
        }

        // –í—ñ–¥–ø—Ä–∞–≤–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å–µ—Å—ñ—ó
        async function trackSession() {
            if (!authToken) return;
            
            try {
                await fetch(`${API_URL}/analytics/session`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify({
                        timestamp: new Date().toISOString(),
                        userAgent: navigator.userAgent,
                        language: navigator.language,
                        screenResolution: `${screen.width}x${screen.height}`
                    })
                });
            } catch (error) {
                console.error('Error tracking session:', error);
            }
        }

        // –í—ñ–¥–ø—Ä–∞–≤–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥—ñ–π
        async function trackAction(action, data = {}) {
            if (!authToken) return;
            
            try {
                await fetch(`${API_URL}/analytics/action`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify({
                        action,
                        data,
                        timestamp: new Date().toISOString()
                    })
                });
            } catch (error) {
                console.error('Error tracking action:', error);
            }
        }

        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
        document.addEventListener('DOMContentLoaded', function() {
            // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ —î –∑–±–µ—Ä–µ–∂–µ–Ω–∏–π —Ç–æ–∫–µ–Ω
            const savedToken = localStorage.getItem('authToken');
            const savedUser = localStorage.getItem('currentUser');
            
            if (savedToken && savedUser) {
                authToken = savedToken;
                currentUser = JSON.parse(savedUser);
                updateUserInterface();
                
                // –í—ñ–¥–∫–ª–∞–¥–µ–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è
                setTimeout(syncWithServer, 1000);
            } else {
                // –ü–æ–∫–∞–∑—É—î–º–æ –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥–∏
                setTimeout(() => {
                    if (!currentUser) {
                        showAuthModal();
                    }
                }, 2000);
            }
            
            updateStatistics();
            generateProgressBars();
            setupAchievements();
            checkDarkModePreference();
            setupThemeToggle();
            setupSpeechToggle();
            setupCatCharacter();
            setupCatTheme();
            
            // –í—ñ–¥—Å—Ç–µ–∂—É—î–º–æ —Å–µ—Å—ñ—é
            trackSession();
        });

        // –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ —É—Å—ñ–º–∞ —ñ—Å–Ω—É—é—á–∏–º–∏ —Ñ—É–Ω–∫—Ü—ñ—è–º–∏
        
        // –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–æ—Ç—è—á–æ—ó —Ç–µ–º–∏
        function setupCatTheme() {
            const standardThemeBtn = document.getElementById('standardTheme');
            const catThemeBtn = document.getElementById('catTheme');
            
            standardThemeBtn.addEventListener('click', function() {
                document.body.classList.remove('cat-theme');
                standardThemeBtn.classList.add('active');
                catThemeBtn.classList.remove('active');
                localStorage.setItem('mathmagic-theme', 'standard');
                trackAction('theme_change', { theme: 'standard' });
            });
            
            catThemeBtn.addEventListener('click', function() {
                document.body.classList.add('cat-theme');
                catThemeBtn.classList.add('active');
                standardThemeBtn.classList.remove('active');
                localStorage.setItem('mathmagic-theme', 'cat');
                showCatBubble(catPhrases.encouragement[Math.floor(Math.random() * catPhrases.encouragement.length)]);
                trackAction('theme_change', { theme: 'cat' });
            });
            
            // –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∑–±–µ—Ä–µ–∂–µ–Ω—É —Ç–µ–º—É
            const savedTheme = localStorage.getItem('mathmagic-theme');
            if (savedTheme === 'cat') {
                document.body.classList.add('cat-theme');
                catThemeBtn.classList.add('active');
                standardThemeBtn.classList.remove('active');
            }
        }
        
        // –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–æ—Ç—è—á–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
        function setupCatCharacter() {
            const catCharacter = document.getElementById('catCharacter');
            
            catCharacter.addEventListener('click', function() {
                // –ê–Ω—ñ–º–∞—Ü—ñ—è –ø—ñ–¥—Å—Ç—Ä–∏–±—É–≤–∞–Ω–Ω—è
                this.classList.remove('cat-idle');
                this.classList.add('cat-bounce');
                setTimeout(() => {
                    this.classList.remove('cat-bounce');
                    this.classList.add('cat-idle');
                }, 500);
                
                // –ü–æ–∫–∞–∑—É—î–º–æ –≤–∏–ø–∞–¥–∫–æ–≤—É —Ä–µ–ø–ª—ñ–∫—É
                const greetings = catPhrases.greetings;
                const randomGreeting = greetings[Math.floor(Math.random() * greetings.length)];
                showCatBubble(randomGreeting);
                
                // –í—ñ–¥—Å—Ç–µ–∂—É—î–º–æ –≤–∑–∞—î–º–æ–¥—ñ—é –∑ –∫–æ—Ç–∏–∫–æ–º
                trackAction('cat_interaction', { greeting: randomGreeting });
                
                // –ü–µ—Ä–µ–≤—ñ—Ä–∏–º–æ, —á–∏ —É–≤—ñ–º–∫–Ω–µ–Ω–∞ –∫–æ—Ç—è—á–∞ —Ç–µ–º–∞, —è–∫—â–æ –Ω—ñ - –∑–∞–ø—Ä–æ–ø–æ–Ω—É—î–º–æ
                if (!document.body.classList.contains('cat-theme')) {
                    setTimeout(() => {
                        if (confirm('–ú—è—É! –•–æ—á–µ—à —É–≤—ñ–º–∫–Ω—É—Ç–∏ –∫–æ—Ç—è—á—É —Ç–µ–º—É?')) {
                            document.body.classList.add('cat-theme');
                            document.getElementById('catTheme').classList.add('active');
                            document.getElementById('standardTheme').classList.remove('active');
                            localStorage.setItem('mathmagic-theme', 'cat');
                            showCatBubble('–ú—É—Ä—Ä—Ä! –î—è–∫—É—é! –¢–µ–ø–µ—Ä –≤—Å–µ –≤–∏–≥–ª—è–¥–∞—î –Ω–∞–±–∞–≥–∞—Ç–æ –∫—Ä–∞—â–µ!');
                            trackAction('theme_change', { theme: 'cat', source: 'cat_suggestion' });
                        }
                    }, 1000);
                }
            });
            
            // –í–∏–ø–∞–¥–∫–æ–≤–∞ –∑–º—ñ–Ω–∞ –ø–æ–ª–æ–∂–µ–Ω–Ω—è –∫–æ—Ç–∏–∫–∞ –∫–æ–∂–Ω—ñ 60 —Å–µ–∫—É–Ω–¥
            setInterval(() => {
                if (Math.random() > 0.7) { // 30% —à–∞–Ω—Å
                    const corners = [
                        { bottom: '20px', right: '20px' },
                        { bottom: '20px', right: 'auto', left: '20px' },
                        { bottom: 'auto', top: '100px', right: '20px' },
                        { bottom: 'auto', top: '100px', right: 'auto', left: '20px' }
                    ];
                    
                    const randomCorner = corners[Math.floor(Math.random() * corners.length)];
                    
                    catCharacter.style.transition = 'all 1.5s ease';
                    Object.keys(randomCorner).forEach(key => {
                        catCharacter.style[key] = randomCorner[key];
                    });
                    
                    // –í–∏–ø–∞–¥–∫–æ–≤–æ –ø–æ–∫–∞–∑—É—î–º–æ —Ä–µ–ø–ª—ñ–∫—É
                    if (Math.random() > 0.6) {
                        const phrases = catPhrases.encouragement;
                        const randomPhrase = phrases[Math.floor(Math.random() * phrases.length)];
                        showCatBubble(randomPhrase);
                    }
                }
            }, 60000);
            
            // –ü–æ–∫–∞–∂–µ–º–æ –≤—ñ—Ç–∞–ª—å–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—ñ–¥ –∫–æ—Ç–∏–∫–∞
            setTimeout(() => {
                const greeting = catPhrases.greetings[Math.floor(Math.random() * catPhrases.greetings.length)];
                showCatBubble(greeting);
            }, 1000);
        }
        
        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–æ–∫–∞–∑—É –±—É–ª—å–±–∞—à–∫–∏ –∑ —Ä–µ–ø–ª—ñ–∫–æ—é –∫–æ—Ç–∞
        function showCatBubble(text) {
            const catBubble = document.getElementById('catBubble');
            const catCharacter = document.getElementById('catCharacter');
            
            // –í–∏–∑–Ω–∞—á–∞—î–º–æ –ø–æ–∑–∏—Ü—ñ—é –∫–æ—Ç–∏–∫–∞
            const catRect = catCharacter.getBoundingClientRect();
            
            // –í–∏–∑–Ω–∞—á–∞—î–º–æ –ø–æ–∑–∏—Ü—ñ—é –±—É–ª—å–±–∞—à–∫–∏ –≤—ñ–¥–Ω–æ—Å–Ω–æ –∫–æ—Ç–∏–∫–∞
            if (catRect.left < window.innerWidth / 2) {
                // –ö–æ—Ç–∏–∫ –∑–ª—ñ–≤–∞, –±—É–ª—å–±–∞—à–∫–∞ —Å–ø—Ä–∞–≤–∞
                catBubble.style.right = 'auto';
                catBubble.style.left = (catRect.right + 20) + 'px';
                catBubble.style.bottom = (window.innerHeight - catRect.top) + 'px';
            } else {
                // –ö–æ—Ç–∏–∫ —Å–ø—Ä–∞–≤–∞, –±—É–ª—å–±–∞—à–∫–∞ –∑–ª—ñ–≤–∞
                catBubble.style.left = 'auto';
                catBubble.style.right = (window.innerWidth - catRect.left + 20) + 'px';
                catBubble.style.bottom = (window.innerHeight - catRect.top) + 'px';
            }
            
            // –û–Ω–æ–≤–ª—é—î–º–æ —Ç–µ–∫—Å—Ç —ñ –ø–æ–∫–∞–∑—É—î–º–æ
            catBubble.textContent = text;
            catBubble.classList.add('visible');
            
            // –ü—Ä–∏—Ö–æ–≤—É—î–º–æ –±—É–ª—å–±–∞—à–∫—É —á–µ—Ä–µ–∑ 4 —Å–µ–∫—É–Ω–¥–∏
            setTimeout(() => {
                catBubble.classList.remove('visible');
            }, 4000);
        }

        // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–µ—Ä–µ–≤–∞–≥ —Ç–µ–º–Ω–æ—ó —Ç–µ–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
        function checkDarkModePreference() {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.body.classList.add('dark-theme');
                document.getElementById('themeToggle').checked = true;
            }

            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
                if (event.matches) {
                    document.body.classList.add('dark-theme');
                    document.getElementById('themeToggle').checked = true;
                } else {
                    document.body.classList.remove('dark-theme');
                    document.getElementById('themeToggle').checked = false;
                }
            });
        }

        // –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–µ—Ä–µ–º–∏–∫–∞—á–∞ —Ç–µ–º–∏
        function setupThemeToggle() {
            const themeToggle = document.getElementById('themeToggle');
            themeToggle.addEventListener('change', function() {
                if (this.checked) {
                    document.body.classList.add('dark-theme');
                    trackAction('theme_toggle', { theme: 'dark' });
                } else {
                    document.body.classList.remove('dark-theme');
                    trackAction('theme_toggle', { theme: 'light' });
                }
            });
        }
        
        // –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –æ–∑–≤—É—á–µ–Ω–Ω—è –∑–∞–≤–¥–∞–Ω—å
        function setupSpeechToggle() {
            const speechToggle = document.getElementById('speechToggle');
            const readProblem = document.getElementById('readProblem');
            
            readProblem.addEventListener('click', function() {
                readProblemAloud();
                trackAction('speech_button_click');
            });
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–∑–≤—É—á–µ–Ω–Ω—è –Ω–æ–≤–∏—Ö –∑–∞–¥–∞—á
            document.addEventListener('problemGenerated', function(e) {
                if (speechToggle.checked) {
                    readProblemAloud();
                }
            });
        }
        
        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω–Ω—è –≤–≥–æ–ª–æ—Å
        function readProblemAloud() {
            if (isSpeaking) {
                speechSynthesis.cancel();
                document.getElementById('readProblem').classList.remove('speaking');
                isSpeaking = false;
                return;
            }
            
            const problemElement = document.getElementById('problemText');
            if (!problemElement) return;
            
            const problemText = problemElement.textContent.replace('√ó', '–ø–æ–º–Ω–æ–∂–∏—Ç–∏ –Ω–∞').replace('=', '–¥–æ—Ä—ñ–≤–Ω—é—î');
            
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(problemText);
                
                // –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≥–æ–ª–æ—Å—É (—É–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –º–æ–≤–∞, —è–∫—â–æ –¥–æ—Å—Ç—É–ø–Ω–∞)
                const voices = speechSynthesis.getVoices();
                const ukrainianVoice = voices.find(voice => voice.lang === 'uk-UA');
                if (ukrainianVoice) {
                    utterance.voice = ukrainianVoice;
                } else {
                    // –Ø–∫—â–æ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—ó –º–æ–≤–∏ –Ω–µ–º–∞—î, —Å–ø—Ä–æ–±—É—î–º–æ —Ä–æ—Å—ñ–π—Å—å–∫—É –∞–±–æ —ñ–Ω—à—É —Å–ª–æ–≤'—è–Ω—Å—å–∫—É
                    const slavicVoice = voices.find(voice => 
                        voice.lang === 'ru-RU' || voice.lang === 'pl-PL' || voice.lang === 'cs-CZ'
                    );
                    if (slavicVoice) utterance.voice = slavicVoice;
                }
                
                utterance.rate = 0.9; // –¢—Ä–æ—Ö–∏ –ø–æ–≤—ñ–ª—å–Ω—ñ—à–µ –¥–ª—è –∫—Ä–∞—â–æ–≥–æ —Ä–æ–∑—É–º—ñ–Ω–Ω—è
                
                // –î–æ–¥–∞—Ç–∏ –∞–Ω—ñ–º–∞—Ü—ñ—é –ø—ñ–¥ —á–∞—Å –æ–∑–≤—É—á–µ–Ω–Ω—è
                document.getElementById('readProblem').classList.add('speaking');
                isSpeaking = true;
                
                utterance.onend = function() {
                    document.getElementById('readProblem').classList.remove('speaking');
                    isSpeaking = false;
                };
                
                speechSynthesis.speak(utterance);
            }
        }

        // –ù–∞–≤—ñ–≥–∞—Ü—ñ—è –º—ñ–∂ —Ä–æ–∑–¥—ñ–ª–∞–º–∏
        function showSection(sectionName) {
            // –ü—Ä–∏—Ö–æ–≤—É—î–º–æ –≤—Å—ñ —Ä–æ–∑–¥—ñ–ª–∏
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // –í–∏–¥–∞–ª—è—î–º–æ –∞–∫—Ç–∏–≤–Ω–∏–π –∫–ª–∞—Å –∑ –∫–Ω–æ–ø–æ–∫
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—É—î–º–æ –ø–æ—Ç—Ä—ñ–±–Ω–∏–π —Ä–æ–∑–¥—ñ–ª
            document.getElementById(sectionName).classList.add('active');
            
            // –ó–Ω–∞—Ö–æ–¥–∏–º–æ –∫–Ω–æ–ø–∫—É —Ä–æ–∑–¥—ñ–ª—É —ñ –¥–æ–¥–∞—î–º–æ –∞–∫—Ç–∏–≤–Ω–∏–π –∫–ª–∞—Å
            document.querySelector(`.nav-btn[onclick="showSection('${sectionName}')"]`).classList.add('active');
            
            currentSection = sectionName;
            
            // –í—ñ–¥—Å—Ç–µ–∂—É—î–º–æ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—é
            trackAction('section_change', { section: sectionName });
            
            if (sectionName === 'statistics') {
                updateStatistics();
                loadGlobalStats();
            } else if (sectionName === 'games') {
                // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –º—ñ–Ω—ñ-—ñ–≥—Ä–∏
                showGame('catchGame');
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É –º—ñ–Ω—ñ-–≥—Ä—É
        function showGame(gameName) {
            // –°—Ö–æ–≤–∞—Ç–∏ –≤—Å—ñ —ñ–≥—Ä–∏
            document.querySelectorAll('.game-container').forEach(game => {
                game.classList.remove('active');
            });
            
            // –í–∏–¥–∞–ª–∏—Ç–∏ –∞–∫—Ç–∏–≤–Ω–∏–π –∫–ª–∞—Å –∑ –∫–Ω–æ–ø–æ–∫ —ñ–≥–æ—Ä
            document.querySelectorAll('.game-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑–∞—Ç–∏ –æ–±—Ä–∞–Ω—É –≥—Ä—É
            document.getElementById(gameName).classList.add('active');
            
            // –ó–Ω–∞–π—Ç–∏ –∫–Ω–æ–ø–∫—É –≥—Ä–∏ —ñ –¥–æ–¥–∞—Ç–∏ –∞–∫—Ç–∏–≤–Ω–∏–π –∫–ª–∞—Å
            document.querySelector(`.game-btn[onclick="showGame('${gameName}')"]`).classList.add('active');
            
            // –í—ñ–¥—Å—Ç–µ–∂—É—î–º–æ –∑–º—ñ–Ω—É –≥—Ä–∏
            trackAction('game_change', { game: gameName });
            
            // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –≥—Ä—É, —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ
            if (gameName === 'catchGame') {
                initCatchGame();
            } else if (gameName === 'memoryGame') {
                setMemoryGameLevel('easy');
            } else if (gameName === 'catGame') {
                initCatGame();
            }
        }

        // –ü–æ–∫–∞–∑ —Ç–∞–±–ª–∏—Ü—ñ –º–Ω–æ–∂–µ–Ω–Ω—è
        function showTable(number) {
            currentTable = number;
            const tableDisplay = document.getElementById('tableDisplay');
            const tableTitle = document.getElementById('tableTitle');
            const tableContent = document.getElementById('tableContent');
            const tableHints = document.getElementById('tableHints');
            const visualAid = document.getElementById('visualAid');
            
            // –í—ñ–¥—Å—Ç–µ–∂—É—î–º–æ –ø–µ—Ä–µ–≥–ª—è–¥ —Ç–∞–±–ª–∏—Ü—ñ
            trackAction('table_view', { table: number });
            
            tableTitle.innerHTML = `–¢–∞–±–ª–∏—Ü—è –º–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ ${number}`;
            
            // –ì–µ–Ω–µ—Ä—É—î–º–æ —Ç–∞–±–ª–∏—Ü—é
            let tableHTML = '';
            for (let i = 1; i <= 10; i++) {
                const result = number * i;
                tableHTML += `
                    <div class="table-row">
                        <span class="equation">${number} √ó ${i}</span>
                        <span class="result">${result}</span>
                    </div>
                `;
            }
            tableContent.innerHTML = tableHTML;
            
            // –î–æ–¥–∞—î–º–æ –ø—ñ–¥–∫–∞–∑–∫–∏
            tableHints.innerHTML = getTableHints(number);
            
            // –í—ñ–∑—É–∞–ª—å–Ω–∞ –¥–æ–ø–æ–º–æ–≥–∞ –¥–ª—è –ø–µ—Ä—à–∏—Ö –ø—Ä–∏–∫–ª–∞–¥—ñ–≤
            if (number <= 5) {
                // –í–∏–∑–Ω–∞—á–∏–º–æ, —á–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∫–æ—Ç—è—á—É –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—é
                const useCatsDots = document.body.classList.contains('cat-theme') || 
                                    document.getElementById('catTasksToggle').checked;
                
                generateVisualAid(number, 3, visualAid, useCatsDots);
            } else {
                visualAid.innerHTML = '';
            }
            
            // –ü—Ä–∏—Ö–æ–≤—É—î–º–æ —Å—ñ—Ç–∫—É —Ç–∞–±–ª–∏—Ü—å —ñ –ø–æ–∫–∞–∑—É—î–º–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É —Ç–∞–±–ª–∏—Ü—é
            document.querySelector('.learning-grid').style.display = 'none';
            tableDisplay.style.display = 'block';
            
            // –í—ñ–¥–∑–Ω–∞—á–∞—î–º–æ, —â–æ —Ü—è —Ç–∞–±–ª–∏—Ü—è –±—É–ª–∞ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∞
            if (!stats.tableProgress[number]) {
                stats.tableProgress[number] = { correct: 0, total: 0, viewed: true };
            } else {
                stats.tableProgress[number].viewed = true;
            }
            saveStats();
            checkAchievements();
        }

        function hideTable() {
            document.querySelector('.learning-grid').style.display = 'grid';
            document.getElementById('tableDisplay').style.display = 'none';
            currentTable = null;
        }

        function startTableTraining() {
            document.getElementById('tableSelect').value = currentTable.toString();
            showSection('training');
            document.querySelector('.nav-btn[onclick="showSection(\'training\')"]').classList.add('active');
            startTraining();
        }

        // –ü—ñ–¥–∫–∞–∑–∫–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü—å
        function getTableHints(number) {
            const hints = {
                1: "–ë—É–¥—å-—è–∫–µ —á–∏—Å–ª–æ, –ø–æ–º–Ω–æ–∂–µ–Ω–µ –Ω–∞ 1, –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –Ω–µ–∑–º—ñ–Ω–Ω–∏–º.",
                2: "–ú–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 2 - —Ü–µ –ø–æ–¥–≤–æ—î–Ω–Ω—è —á–∏—Å–ª–∞. –ú–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ —á–∏—Å–ª–æ –¥–æ —Å–∞–º–æ–≥–æ —Å–µ–±–µ.",
                3: "–î–ª—è –º–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 3 –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ª—ñ—á–∏–ª—å–∫—É –Ω–∞ –ø–∞–ª—å—Ü—è—Ö –∞–±–æ –¥–æ–¥–∞–≤–∞—Ç–∏ —á–∏—Å–ª–æ —Ç—Ä–∏—á—ñ.",
                4: "–ú–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 4 - —Ü–µ –ø–æ–¥–≤–æ—î–Ω–Ω—è –ø–æ–¥–≤–æ—î–Ω–æ–≥–æ —á–∏—Å–ª–∞. –°–ø–æ—á–∞—Ç–∫—É –ø–æ–º–Ω–æ–∂ –Ω–∞ 2, –ø–æ—Ç—ñ–º —â–µ —Ä–∞–∑ –Ω–∞ 2.",
                5: "–†–µ–∑—É–ª—å—Ç–∞—Ç –º–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 5 –∑–∞–≤–∂–¥–∏ –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è –Ω–∞ 0 –∞–±–æ 5. –ü–æ–ª–æ–≤–∏–Ω–∞ —á–∏—Å–ª–∞ √ó 10.",
                6: "–ú–æ–∂–Ω–∞ –ø–æ–º–Ω–æ–∂–∏—Ç–∏ –Ω–∞ 3, –∞ –ø–æ—Ç—ñ–º –Ω–∞ 2, –∞–±–æ –Ω–∞–≤–ø–∞–∫–∏.",
                7: "–û–¥–Ω–∞ –∑ –Ω–∞–π—Å–∫–ª–∞–¥–Ω—ñ—à–∏—Ö —Ç–∞–±–ª–∏—Ü—å. –ü–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–ø–∞–º'—è—Ç–∞—Ç–∏ –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—è.",
                8: "–ü–æ–¥–≤–æ—î–Ω–Ω—è —á–∏—Å–ª–∞ —Ç—Ä–∏—á—ñ: √ó 2, –ø–æ—Ç—ñ–º √ó 2, –ø–æ—Ç—ñ–º √ó 2.",
                9: "–¶—ñ–∫–∞–≤–∏–π —Ç—Ä—é–∫: —Å—É–º–∞ —Ü–∏—Ñ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –∑–∞–≤–∂–¥–∏ –¥–æ—Ä—ñ–≤–Ω—é—î 9 (–¥–æ 9√ó10).",
                10: "–ù–∞–π–ª–µ–≥—à–∞ —Ç–∞–±–ª–∏—Ü—è - –ø—Ä–æ—Å—Ç–æ –¥–æ–¥–∞–π –Ω—É–ª—å –¥–æ —á–∏—Å–ª–∞!"
            };
            
            // –î–æ–¥–∞—î–º–æ "–∫–æ—Ç—è—á—ñ" –ø—ñ–¥–∫–∞–∑–∫–∏, —è–∫—â–æ –≤–∫–ª—é—á–µ–Ω–∞ –∫–æ—Ç—è—á–∞ —Ç–µ–º–∞
            if (document.body.classList.contains('cat-theme')) {
                const catHints = {
                    1: "–ú—è—É! –ö–æ–∂–µ–Ω –∫–æ—Ç–∏–∫ –º–∞—î 1 —Ö–≤–æ—Å—Ç–∏–∫. –ö–æ–ª–∏ –º–Ω–æ–∂–∏–º–æ –Ω–∞ 1, –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ö–≤–æ—Å—Ç–∏–∫—ñ–≤ –Ω–µ –∑–º—ñ–Ω—é—î—Ç—å—Å—è.",
                    2: "–ú—É—Ä—Ä—Ä! –£ –∫–æ–∂–Ω–æ–≥–æ –∫–æ—Ç–∏–∫–∞ –ø–æ 2 –≤—É—à–∫–∞. –†–∞—Ö—É—î–º–æ –≤—É—à–∫–∞ —É –∫—ñ–ª—å–∫–æ—Ö –∫–æ—Ç–∏–∫—ñ–≤.",
                    3: "–ù—è–≤! –ö–æ–ª–∏ –∫–æ—Ç–∏–∫ –æ—Ç—Ä–∏–º—É—î –ø–æ 3 —Å–º–∞–∫–æ–ª–∏–∫–∏, –º–∏ –º–æ–∂–µ–º–æ –ø–æ—Ä–∞—Ö—É–≤–∞—Ç–∏ —Å–º–∞–∫–æ–ª–∏–∫–∏ –¥–ª—è –≥—Ä—É–ø–∏ –∫–æ—Ç–∏–∫—ñ–≤.",
                    4: "–ú—è—É! –£ –∫–æ—Ç–∏–∫–∞ 4 –ª–∞–ø–∫–∏. –†–∞—Ö—É—î–º–æ –≤—Å—ñ –ª–∞–ø–∫–∏ —É –≥—Ä—É–ø–∏ –∫–æ—Ç–∏–∫—ñ–≤.",
                    5: "–ú—É—Ä-–º—É—Ä! –Ø–∫—â–æ –¥–∞—Ç–∏ 5 —Å–º–∞–∫–æ–ª–∏–∫—ñ–≤ –∫–æ–∂–Ω–æ–º—É –∫–æ—Ç–∏–∫—É, –º–æ–∂–Ω–∞ –ø–æ—Ä–∞—Ö—É–≤–∞—Ç–∏ –≤—Å—ñ —Å–º–∞–∫–æ–ª–∏–∫–∏.",
                    6: "–ö–æ–∂–µ–Ω –∫–æ—Ç–∏–∫ –º–æ–∂–µ –∑'—ó—Å—Ç–∏ 6 —Ä–∏–±–æ–∫. –°–∫—ñ–ª—å–∫–∏ —Ä–∏–±–æ–∫ –∑'—ó–¥—è—Ç—å –∫—ñ–ª—å–∫–∞ –∫–æ—Ç–∏–∫—ñ–≤?",
                    7: "–ö–æ—Ç–∏–∫ —Å–ø–∏—Ç—å 7 –≥–æ–¥–∏–Ω –Ω–∞ –¥–µ–Ω—å. –°–∫—ñ–ª—å–∫–∏ –≥–æ–¥–∏–Ω –≤—ñ–Ω —Å–ø–∏—Ç—å –∑–∞ –∫—ñ–ª—å–∫–∞ –¥–Ω—ñ–≤?",
                    8: "–ù—è–≤-–º—É—Ä! –°–∫—ñ–ª—å–∫–∏ —Å–º–∞–∫–æ–ª–∏–∫—ñ–≤ –æ—Ç—Ä–∏–º–∞—é—Ç—å 8 –∫–æ—Ç–∏–∫—ñ–≤, —è–∫—â–æ –∫–æ–∂–Ω–æ–º—É –¥–∞—Ç–∏ –æ–¥–Ω–∞–∫–æ–≤—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å?",
                    9: "–ú—è—É! –£ 9 –∫–æ—Ç–∏–∫—ñ–≤ –ø–æ 4 –ª–∞–ø–∫–∏. –°–∫—ñ–ª—å–∫–∏ –≤—Å—å–æ–≥–æ –ª–∞–ø–æ–∫?",
                    10: "–ü–æ—Ä–∞—Ö—É–≤–∞—Ç–∏ —Å–º–∞–∫–æ–ª–∏–∫–∏ –¥–ª—è 10 –∫–æ—Ç–∏–∫—ñ–≤ –ø—Ä–æ—Å—Ç–æ - –ø–æ–º–Ω–æ–∂ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–º–∞–∫–æ–ª–∏–∫—ñ–≤ –¥–ª—è –æ–¥–Ω–æ–≥–æ –∫–æ—Ç–∏–∫–∞ –Ω–∞ 10!"
                };
                
                return `<p>${hints[number]}</p>
                       <p style="margin-top: 10px;"><span class="cat-footprint">üêæ</span> ${catHints[number]}</p>`;
            }
            
            return hints[number] || "";
        }

        // –í—ñ–∑—É–∞–ª—å–Ω–∞ –¥–æ–ø–æ–º–æ–≥–∞
        function generateVisualAid(multiplier, multiplicand, container, useCatDots = false) {
            container.innerHTML = '';
            
            // –î–æ–¥–∞—î–º–æ –∫–ª–∞—Å –¥–ª—è –∫–æ—Ç—è—á–æ—ó –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó, —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ
            if (useCatDots) {
                container.classList.add('cat-dots');
            } else {
                container.classList.remove('cat-dots');
            }
            
            for (let i = 0; i < multiplier; i++) {
                const dotGroup = document.createElement('div');
                dotGroup.className = 'dot-group';
                
                const dots = document.createElement('div');
                dots.className = 'dots';
                dots.style.gridTemplateColumns = `repeat(${Math.min(multiplicand, 5)}, 1fr)`;
                
                for (let j = 0; j < multiplicand; j++) {
                    const dot = document.createElement('div');
                    dot.className = 'dot';
                    dot.style.animationDelay = `${(i * multiplicand + j) * 0.1}s`;
                    dots.appendChild(dot);
                }
                
                const label = document.createElement('div');
                
                // –Ø–∫—â–æ –∫–æ—Ç—è—á–∞ —Ç–µ–º–∞, –¥–æ–¥–∞—î–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ –ø—ñ–¥–ø–∏—Å–∏
                if (useCatDots) {
                    label.innerHTML = `<span class="cat-task-icon">üê±</span>–ö–æ—Ç–∏–∫ ${i + 1}`;
                } else {
                    label.textContent = `–ì—Ä—É–ø–∞ ${i + 1}`;
                }
                
                label.style.fontSize = '0.9em';
                label.style.opacity = '0.8';
                
                dotGroup.appendChild(dots);
                dotGroup.appendChild(label);
                container.appendChild(dotGroup);
            }
            
            const result = document.createElement('div');
            result.style.marginTop = '15px';
            result.style.fontSize = '1.2em';
            result.style.fontWeight = 'bold';
            
            if (useCatDots) {
                // –í–∏–±–∏—Ä–∞—î–º–æ —Ç–∏–ø –ø—Ä–µ–¥–º–µ—Ç–∞ –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ
                let itemType;
                if (multiplicand === 4) {
                    itemType = { single: '–ª–∞–ø–∫–∞', few: '–ª–∞–ø–∫–∏', many: '–ª–∞–ø–æ–∫' };
                } else if (multiplicand === 2) {
                    itemType = { single: '–≤—É—à–∫–æ', few: '–≤—É—à–∫–∞', many: '–≤—É—à–æ–∫' };
                } else if (multiplicand === 1) {
                    itemType = { single: '—Ö–≤–æ—Å—Ç–∏–∫', few: '—Ö–≤–æ—Å—Ç–∏–∫–∏', many: '—Ö–≤–æ—Å—Ç–∏–∫—ñ–≤' };
                } else {
                    itemType = { single: '—Å–º–∞–∫–æ–ª–∏–∫', few: '—Å–º–∞–∫–æ–ª–∏–∫–∏', many: '—Å–º–∞–∫–æ–ª–∏–∫—ñ–≤' };
                }
                
                // –í–∏–∑–Ω–∞—á–∞—î–º–æ –ø—Ä–∞–≤–∏–ª—å–Ω—É —Ñ–æ—Ä–º—É —Å–ª–æ–≤–∞ –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
                const totalCount = multiplier * multiplicand;
                let itemForm;
                if (totalCount % 10 === 1 && totalCount % 100 !== 11) {
                    itemForm = itemType.single;
                } else if ([2, 3, 4].includes(totalCount % 10) && ![12, 13, 14].includes(totalCount % 100)) {
                    itemForm = itemType.few;
                } else {
                    itemForm = itemType.many;
                }
                
                // –í–∏–∑–Ω–∞—á–∞—î–º–æ –ø—Ä–∞–≤–∏–ª—å–Ω—É —Ñ–æ—Ä–º—É —Å–ª–æ–≤–∞ –¥–ª—è –ø–æ—á–∞—Ç–∫–æ–≤–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ
                let startItemForm;
                if (multiplicand % 10 === 1 && multiplicand % 100 !== 11) {
                    startItemForm = itemType.single;
                } else if ([2, 3, 4].includes(multiplicand % 10) && ![12, 13, 14].includes(multiplicand % 100)) {
                    startItemForm = itemType.few;
                } else {
                    startItemForm = itemType.many;
                }
                
                result.innerHTML = `${multiplier} –∫–æ—Ç–∏–∫${multiplier > 1 ? '–∏' : ''} √ó ${multiplicand} ${startItemForm} = ${totalCount} ${itemForm}`;
            } else {
                result.innerHTML = `${multiplier} –≥—Ä—É–ø–∏ –ø–æ ${multiplicand} = ${multiplier * multiplicand}`;
            }
            
            container.appendChild(result);
        }

        // –¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è
        function startTraining() {
            trainingData.tableMode = document.getElementById('tableSelect').value;
            trainingData.difficulty = document.getElementById('difficultySelect').value;
            trainingData.hintsEnabled = document.getElementById('hintToggle').checked;
            
            // –í—ñ–¥—Å—Ç–µ–∂—É—î–º–æ –ø–æ—á–∞—Ç–æ–∫ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è
            trackAction('training_start', {
                tableMode: trainingData.tableMode,
                difficulty: trainingData.difficulty,
                hintsEnabled: trainingData.hintsEnabled
            });
            
            document.getElementById('trainingArea').classList.add('active');
            document.getElementById('hintArea').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'none';
            
            // –í–∏–∑–Ω–∞—á–∞—î–º–æ, —á–∏ –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è –∑ –∫–æ—Ç–∏–∫–∞–º–∏
            const showCatTask = document.getElementById('catTasksToggle').checked && Math.random() > 0.5;
            
            if (showCatTask && trainingData.tableMode !== 'mixed') {
                const tableNum = parseInt(trainingData.tableMode);
                const filteredTasks = catTasks.filter(task => 
                    task.a === tableNum || task.b === tableNum
                );
                
                if (filteredTasks.length > 0) {
                    const randomTask = filteredTasks[Math.floor(Math.random() * filteredTasks.length)];
                    document.getElementById('catTask').style.display = 'block';
                    document.getElementById('catTaskText').textContent = randomTask.text;
                    
                    trainingData.currentProblem = {
                        a: randomTask.a,
                        b: randomTask.b,
                        answer: randomTask.a * randomTask.b,
                        isCatTask: true
                    };
                    
                    document.getElementById('problemText').textContent = `${randomTask.a} √ó ${randomTask.b} = ?`;
                    document.getElementById('answerInput').value = '';
                    document.getElementById('answerInput').disabled = false;
                    document.getElementById('answerInput').focus();
                    document.getElementById('trainingFeedback').textContent = '';
                    document.getElementById('trainingFeedback').className = 'feedback';
                    
                    // –í–∏–∫–ª–∏–∫–∞—î–º–æ –ø–æ–¥—ñ—é –ø—Ä–æ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω—É –∑–∞–¥–∞—á—É –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –æ–∑–≤—É—á–µ–Ω–Ω—è
                    document.dispatchEvent(new Event('problemGenerated'));
                    return;
                }
            }
            
            // –Ø–∫—â–æ –Ω–µ –ø–æ–∫–∞–∑—É—î–º–æ –∑–∞–≤–¥–∞–Ω–Ω—è –∑ –∫–æ—Ç–∏–∫–∞–º–∏, —Ç–æ –ø–æ–∫–∞–∑—É—î–º–æ –∑–≤–∏—á–∞–π–Ω–µ
            document.getElementById('catTask').style.display = 'none';
            nextProblem();
        }

        function nextProblem() {
            // –ì–µ–Ω–µ—Ä—É—î–º–æ –Ω–æ–≤–∏–π –ø—Ä–∏–∫–ª–∞–¥
            const problem = generateProblem();
            trainingData.currentProblem = problem;
            
            document.getElementById('problemText').textContent = `${problem.a} √ó ${problem.b} = ?`;
            document.getElementById('answerInput').value = '';
            document.getElementById('answerInput').disabled = false;
            document.getElementById('answerInput').focus();
            document.getElementById('trainingFeedback').textContent = '';
            document.getElementById('trainingFeedback').className = 'feedback';
            document.getElementById('hintArea').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'none';
            
            // –°–∫–∏–¥–∞—î–º–æ –∑–∞–≤–¥–∞–Ω–Ω—è –∑ –∫–æ—Ç–∏–∫–∞–º–∏
            document.getElementById('catTask').style.display = 'none';
            
            // –í–∏–∫–ª–∏–∫–∞—î–º–æ –ø–æ–¥—ñ—é –ø—Ä–æ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω—É –∑–∞–¥–∞—á—É –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –æ–∑–≤—É—á–µ–Ω–Ω—è
            document.dispatchEvent(new Event('problemGenerated'));
        }

        function generateProblem() {
            let a, b;
            
            if (trainingData.tableMode === 'mixed') {
                // –ì–µ–Ω–µ—Ä—É—î–º–æ –≤–∏–ø–∞–¥–∫–æ–≤—ñ —á–∏—Å–ª–∞ –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ
                switch(trainingData.difficulty) {
                    case 'easy':
                        a = Math.floor(Math.random() * 5) + 1;
                        b = Math.floor(Math.random() * 5) + 1;
                        break;
                    case 'medium':
                        a = Math.floor(Math.random() * 5) + 6;
                        b = Math.floor(Math.random() * 5) + 6;
                        break;
                    case 'hard':
                        a = Math.floor(Math.random() * 10) + 1;
                        b = Math.floor(Math.random() * 10) + 1;
                        break;
                    default:
                        a = Math.floor(Math.random() * 10) + 1;
                        b = Math.floor(Math.random() * 10) + 1;
                }
            } else {
                const table = parseInt(trainingData.tableMode);
                a = table;
                let minB = 1, maxB = 10;
                
                switch(trainingData.difficulty) {
                    case 'easy':
                        minB = 1;
                        maxB = 5;
                        break;
                    case 'medium':
                        minB = 6;
                        maxB = 10;
                        break;
                    case 'hard':
                        minB = 1;
                        maxB = 10;
                        break;
                }
                
                b = Math.floor(Math.random() * (maxB - minB + 1)) + minB;
            }
            
            return { a, b, answer: a * b };
        }

        function checkTrainingAnswer() {
            const userAnswer = parseInt(document.getElementById('answerInput').value);
            const correctAnswer = trainingData.currentProblem.answer;
            const feedback = document.getElementById('trainingFeedback');
            
            if (isNaN(userAnswer) || document.getElementById('answerInput').value === '') {
                feedback.textContent = '–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å —á–∏—Å–ª–æ–≤—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å';
                feedback.className = 'feedback incorrect';
                return;
            }
            
            stats.totalProblems++;
            
            // –Ø–∫—â–æ —Ü–µ –±—É–ª–æ –∫–æ—Ç—è—á–µ –∑–∞–≤–¥–∞–Ω–Ω—è, –∑–±—ñ–ª—å—à—É—î–º–æ –ª—ñ—á–∏–ª—å–Ω–∏–∫
            if (trainingData.currentProblem.isCatTask) {
                stats.catTasksSolved = (stats.catTasksSolved || 0) + 1;
            }
            
            const isCorrect = userAnswer === correctAnswer;
            
            // –í—ñ–¥—Å—Ç–µ–∂—É—î–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å
            trackAction('answer_submitted', {
                problem: `${trainingData.currentProblem.a} √ó ${trainingData.currentProblem.b}`,
                userAnswer,
                correctAnswer,
                isCorrect,
                isCatTask: trainingData.currentProblem.isCatTask
            });
            
            if (isCorrect) {
                feedback.textContent = 'üéâ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! –ú–æ–ª–æ–¥–µ—Ü—å!';
                feedback.className = 'feedback correct';
                stats.correctAnswers++;
                stats.currentStreak++;
                
                // –ü—Ä–æ–≥—Ä–∞—î–º–æ –∑–≤—É–∫ —É—Å–ø—ñ—Ö—É
                try {
                    playSuccessSound();
                } catch(e) {
                    console.log('Audio not supported');
                }
                
                // –ü–æ–∫–∞–∑—É—î–º–æ —Ä–µ–∞–∫—Ü—ñ—é –∫–æ—Ç–∏–∫–∞, —è–∫—â–æ —É–≤—ñ–º–∫–Ω–µ–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∞ –æ–ø—Ü—ñ—è
                if (document.getElementById('catTasksToggle').checked || document.body.classList.contains('cat-theme')) {
                    const catReactions = catPhrases.correct;
                    const randomReaction = catReactions[Math.floor(Math.random() * catReactions.length)];
                    showCatBubble(randomReaction);
                }
                
                // –û–Ω–æ–≤–ª—é—î–º–æ –ø—Ä–æ–≥—Ä–µ—Å –ø–æ —Ç–∞–±–ª–∏—Ü—ñ
                const tableKey = trainingData.currentProblem.a;
                if (!stats.tableProgress[tableKey]) {
                    stats.tableProgress[tableKey] = { correct: 0, total: 0 };
                }
                stats.tableProgress[tableKey].correct++;
                stats.tableProgress[tableKey].total++;
                
                if (stats.currentStreak > stats.bestStreak) {
                    stats.bestStreak = stats.currentStreak;
                }
            } else {
                feedback.textContent = `–ù–µ –∑–æ–≤—Å—ñ–º —Ç–∞–∫. –ü—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å: ${correctAnswer}`;
                feedback.className = 'feedback incorrect';
                stats.currentStreak = 0;
                
                // –ü—Ä–æ–≥—Ä–∞—î–º–æ –∑–≤—É–∫ –ø–æ–º–∏–ª–∫–∏
                try {
                    playErrorSound();
                } catch(e) {
                    console.log('Audio not supported');
                }
                
                // –ü–æ–∫–∞–∑—É—î–º–æ —Ä–µ–∞–∫—Ü—ñ—é –∫–æ—Ç–∏–∫–∞, —è–∫—â–æ —É–≤—ñ–º–∫–Ω–µ–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∞ –æ–ø—Ü—ñ—è
                if (document.getElementById('catTasksToggle').checked || document.body.classList.contains('cat-theme')) {
                    const catReactions = catPhrases.incorrect;
                    const randomReaction = catReactions[Math.floor(Math.random() * catReactions.length)];
                    showCatBubble(randomReaction);
                }
                
                // –û–Ω–æ–≤–ª—é—î–º–æ –ø—Ä–æ–≥—Ä–µ—Å –ø–æ —Ç–∞–±–ª–∏—Ü—ñ
                const tableKey = trainingData.currentProblem.a;
                if (!stats.tableProgress[tableKey]) {
                    stats.tableProgress[tableKey] = { correct: 0, total: 0 };
                }
                stats.tableProgress[tableKey].total++;
            }
            
            saveStats();
            checkAchievements();
            document.getElementById('nextBtn').style.display = 'inline-block';
            
            // –ë–ª–æ–∫—É—î–º–æ –ø–æ–ª–µ –≤–≤–µ–¥–µ–Ω–Ω—è –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–Ω—è
            document.getElementById('answerInput').disabled = true;
        }

        function showHint() {
            if (!trainingData.hintsEnabled) return;
            
            const hintArea = document.getElementById('hintArea');
            const hintContent = document.getElementById('hintContent');
            const hintVisual = document.getElementById('hintVisual');
            const problem = trainingData.currentProblem;
            
            // –í—ñ–¥—Å—Ç–µ–∂—É—î–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø—ñ–¥–∫–∞–∑–∫–∏
            trackAction('hint_used', {
                problem: `${problem.a} √ó ${problem.b}`
            });
            
            // –ì–µ–Ω–µ—Ä—É—î–º–æ –ø—ñ–¥–∫–∞–∑–∫—É
            let hint = '';
            if (problem.a === 1 || problem.b === 1) {
                hint = '–ë—É–¥—å-—è–∫–µ —á–∏—Å–ª–æ √ó 1 = —Ü–µ —Å–∞–º–µ —á–∏—Å–ª–æ';
            } else if (problem.a === 2 || problem.b === 2) {
                const other = problem.a === 2 ? problem.b : problem.a;
                hint = `–ú–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 2 - —Ü–µ –ø–æ–¥–≤–æ—î–Ω–Ω—è. ${other} + ${other} = ${other * 2}`;
            } else if (problem.a === 5 || problem.b === 5) {
                hint = '–†–µ–∑—É–ª—å—Ç–∞—Ç –º–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 5 –∑–∞–≤–∂–¥–∏ –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è –Ω–∞ 0 –∞–±–æ 5';
            } else if (problem.a === 9 || problem.b === 9) {
                hint = '–¢—Ä—é–∫ –∑ 9: —Å—É–º–∞ —Ü–∏—Ñ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –¥–æ—Ä—ñ–≤–Ω—é—î 9';
            } else if (problem.a === 10 || problem.b === 10) {
                const other = problem.a === 10 ? problem.b : problem.a;
                hint = `–ú–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ 10 - –ø—Ä–æ—Å—Ç–æ –¥–æ–¥–∞–π –Ω—É–ª—å: ${other}0`;
            } else {
                hint = `–°–ø—Ä–æ–±—É–π –¥–æ–¥–∞—Ç–∏ ${problem.a} —Å–∞–º–µ –¥–æ —Å–µ–±–µ ${problem.b} —Ä–∞–∑—ñ–≤`;
            }
            
            // –Ø–∫—â–æ –∫–æ—Ç—è—á–∞ —Ç–µ–º–∞, –¥–æ–¥–∞—î–º–æ "–∫–æ—Ç—è—á—É" –ø—ñ–¥–∫–∞–∑–∫—É
            if (document.body.classList.contains('cat-theme') || document.getElementById('catTasksToggle').checked) {
                // –í–∏–∑–Ω–∞—á–∞—î–º–æ –ø—ñ–¥–∫–∞–∑–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —á–∏—Å–µ–ª —Ç–∞ —ó—Ö –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç–µ–π
                const catHintType = getCatHintType(problem.a, problem.b);
                
                hint += `<br><br><span class="cat-task-icon">üê±</span> ${catHintType}`;
            }
            
            hintContent.innerHTML = hint;
            
            // –í–∏–∑–Ω–∞—á–∞—î–º–æ, —á–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∫–æ—Ç—è—á—É –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—é
            const useCatsDots = document.body.classList.contains('cat-theme') || 
                                document.getElementById('catTasksToggle').checked;
            
            // –í—ñ–∑—É–∞–ª—å–Ω–∞ –ø—ñ–¥–∫–∞–∑–∫–∞ –¥–ª—è –ø—Ä–æ—Å—Ç–∏—Ö –≤–∏–ø–∞–¥–∫—ñ–≤
            if (problem.a <= 5 && problem.b <= 5) {
                generateVisualAid(problem.a, problem.b, hintVisual, useCatsDots);
            } else {
                hintVisual.innerHTML = '';
            }
            
            hintArea.style.display = 'block';
        }
        
        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∏–ø—É –∫–æ—Ç—è—á–æ—ó –ø—ñ–¥–∫–∞–∑–∫–∏ –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —á–∏—Å–µ–ª
        function getCatHintType(a, b) {
            // –¶–µ –¥–æ–∑–≤–æ–ª—è—î –ø—Ä–∏—Ä–æ–¥–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ "–∫–æ—Ç—è—á—ñ" –µ–ª–µ–º–µ–Ω—Ç–∏
            let smallerNum = Math.min(a, b);
            let largerNum = Math.max(a, b);
            
            if (smallerNum === 4 || largerNum === 4) {
                // –Ø–∫—â–æ –æ–¥–Ω–µ –∑ —á–∏—Å–µ–ª 4, —Ç–æ —Ü–µ –ª–∞–ø–∫–∏
                return `–£ ${smallerNum} –∫–æ—Ç–∏–∫—ñ–≤ –ø–æ 4 –ª–∞–ø–∫–∏. –í—Å—å–æ–≥–æ ${smallerNum * 4} –ª–∞–ø–æ–∫.`;
            } else if (smallerNum === 2 || largerNum === 2) {
                // –Ø–∫—â–æ –æ–¥–Ω–µ –∑ —á–∏—Å–µ–ª 2, —Ç–æ —Ü–µ –≤—É—à–∫–∞
                return `–£ ${smallerNum} –∫–æ—Ç–∏–∫—ñ–≤ –ø–æ 2 –≤—É—à–∫–∞. –í—Å—å–æ–≥–æ ${smallerNum * 2} –≤—É—à–∫–∞.`;
            } else if (smallerNum === 1 || largerNum === 1) {
                // –Ø–∫—â–æ –æ–¥–Ω–µ –∑ —á–∏—Å–µ–ª 1, —Ç–æ —Ü–µ —Ö–≤–æ—Å—Ç–∏–∫–∏
                return `–£ ${largerNum} –∫–æ—Ç–∏–∫—ñ–≤ –ø–æ 1 —Ö–≤–æ—Å—Ç–∏–∫—É. –í—Å—å–æ–≥–æ ${largerNum} —Ö–≤–æ—Å—Ç–∏–∫—ñ–≤.`;
            } else if (smallerNum === 12 || largerNum === 12) {
                // –Ø–∫—â–æ –æ–¥–Ω–µ –∑ —á–∏—Å–µ–ª 12, —Ç–æ —Ü–µ –≤—É—Å–∏–∫–∏
                return `–£ ${a === 12 ? b : a} –∫–æ—Ç–∏–∫—ñ–≤ –ø–æ 12 –≤—É—Å–∏–∫—ñ–≤. –í—Å—å–æ–≥–æ ${a * b} –≤—É—Å–∏–∫—ñ–≤.`;
            } else {
                // –í —ñ–Ω—à–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Å–º–∞–∫–æ–ª–∏–∫–∏
                return `–Ø–∫—â–æ –¥–∞—Ç–∏ –∫–æ–∂–Ω–æ–º—É –∑ ${a} –∫–æ—Ç–∏–∫—ñ–≤ –ø–æ ${b} —Å–º–∞–∫–æ–ª–∏–∫—ñ–≤, –≤—Å—å–æ–≥–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ ${a * b} —Å–º–∞–∫–æ–ª–∏–∫—ñ–≤.`;
            }
        }

        function checkEnter(event) {
            if (event.key === 'Enter') {
                checkTrainingAnswer();
            }
        }

        // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        function updateStatistics() {
            document.getElementById('totalProblems').textContent = stats.totalProblems;
            document.getElementById('correctAnswers').textContent = stats.correctAnswers;
            
            const accuracy = stats.totalProblems > 0 ? 
                Math.round((stats.correctAnswers / stats.totalProblems) * 100) : 0;
            document.getElementById('accuracy').textContent = accuracy + '%';
            
            document.getElementById('currentStreak').textContent = stats.currentStreak;
            
            generateProgressBars();
            updateAchievements();
        }

        function generateProgressBars() {
            const progressList = document.getElementById('progressList');
            progressList.innerHTML = '';
            
            for (let i = 1; i <= 10; i++) {
                const progress = stats.tableProgress[i] || { correct: 0, total: 0 };
                const percentage = progress.total > 0 ? 
                    Math.round((progress.correct / progress.total) * 100) : 0;
                
                const progressItem = document.createElement('div');
                progressItem.className = 'progress-item';
                
                // –î–æ–¥–∞—î–º–æ –∫–æ—Ç—è—á—É —ñ–∫–æ–Ω–∫—É –¥–ª—è —Ç–∞–±–ª–∏—Ü—å, —è–∫—â–æ –≤–∏–±—Ä–∞–Ω–∞ –∫–æ—Ç—è—á–∞ —Ç–µ–º–∞
                const catIcon = document.body.classList.contains('cat-theme') ? 
                                '<span class="cat-task-icon">üê±</span>' : '';
                
                progressItem.innerHTML = `
                    <span>${catIcon}–¢–∞–±–ª–∏—Ü—è –º–Ω–æ–∂–µ–Ω–Ω—è –Ω–∞ ${i}</span>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${percentage}%"></div>
                    </div>
                    <span>${percentage}% (${progress.correct}/${progress.total})</span>
                `;
                
                progressList.appendChild(progressItem);
            }
        }

        function saveStats() {
            localStorage.setItem('multiplicationStats', JSON.stringify(stats));
            
            // –í—ñ–¥–∫–ª–∞–¥–µ–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –∑ —Å–µ—Ä–≤–µ—Ä–æ–º
            if (authToken) {
                setTimeout(syncWithServer, 5000);
            }
        }

        function resetStats() {
            if (confirm('–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ —Å–∫–∏–Ω—É—Ç–∏ –≤—Å—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É?')) {
                trackAction('stats_reset');
                
                stats = {
                    totalProblems: 0,
                    correctAnswers: 0,
                    tableProgress: {},
                    currentStreak: 0,
                    bestStreak: 0,
                    unlockedAchievements: [],
                    catTasksSolved: 0,
                    gameScores: {
                        catchGame: 0,
                        memoryGameEasy: false,
                        memoryGameMedium: false,
                        memoryGameHard: false,
                        memoryGamePerfect: false,
                        catGame: 0
                    }
                };
                saveStats();
                updateStatistics();
            }
        }
        
        // –§—É–Ω–∫—Ü—ñ—ó –¥–ª—è –µ–∫—Å–ø–æ—Ä—Ç—É/—ñ–º–ø–æ—Ä—Ç—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function exportStats() {
            trackAction('stats_export');
            
            const dataStr = JSON.stringify(stats, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'matematika_progress.json';
            link.click();
        }

        function importStats(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const importedStats = JSON.parse(e.target.result);
                        stats = importedStats;
                        saveStats();
                        updateStatistics();
                        trackAction('stats_import', { success: true });
                        alert('–°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —É—Å–ø—ñ—à–Ω–æ —ñ–º–ø–æ—Ä—Ç–æ–≤–∞–Ω–æ!');
                    } catch (error) {
                        trackAction('stats_import', { success: false, error: error.message });
                        alert('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —ñ–º–ø–æ—Ä—Ç—ñ —Ñ–∞–π–ª—É. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ñ–æ—Ä–º–∞—Ç.');
                    }
                };
                reader.readAsText(file);
            }
        }

        // –î–æ—Å—è–≥–Ω–µ–Ω–Ω—è
        function setupAchievements() {
            const achievementsGrid = document.getElementById('achievementsGrid');
            achievementsGrid.innerHTML = '';
            
            achievements.forEach(achievement => {
                const card = document.createElement('div');
                card.className = 'achievement-card';
                card.id = `achievement-${achievement.id}`;
                card.innerHTML = `
                    <div class="achievement-icon">${achievement.icon}</div>
                    <div class="achievement-title">${achievement.title}</div>
                    <div class="achievement-description">${achievement.description}</div>
                `;
                achievementsGrid.appendChild(card);
            });
            
            updateAchievements();
        }
        
        function updateAchievements() {
            achievements.forEach(achievement => {
                const card = document.getElementById(`achievement-${achievement.id}`);
                if (!card) return;
                
                const isUnlocked = stats.unlockedAchievements && 
                                   stats.unlockedAchievements.includes(achievement.id);
                
                if (isUnlocked) {
                    card.classList.add('unlocked');
                    card.classList.remove('locked');
                } else {
                    card.classList.add('locked');
                    card.classList.remove('unlocked');
                }
            });
        }
        
        function checkAchievements() {
            if (!stats.unlockedAchievements) {
                stats.unlockedAchievements = [];
            }
            
            let newAchievements = [];
            
            achievements.forEach(achievement => {
                if (!stats.unlockedAchievements.includes(achievement.id) && 
                    achievement.condition(stats)) {
                    stats.unlockedAchievements.push(achievement.id);
                    newAchievements.push(achievement);
                }
            });
            
            if (newAchievements.length > 0) {
                saveStats();
                updateAchievements();
                
                // –í—ñ–¥—Å—Ç–µ–∂—É—î–º–æ —Ä–æ–∑–±–ª–æ–∫—É–≤–∞–Ω–Ω—è –¥–æ—Å—è–≥–Ω–µ–Ω—å
                newAchievements.forEach(achievement => {
                    trackAction('achievement_unlocked', { achievement: achievement.id });
                });
                
                // –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑–∞—Ä–∞–∑ —É —Ä–æ–∑–¥—ñ–ª—ñ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏, –∞–Ω—ñ–º—É—î–º–æ –Ω–æ–≤—ñ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è
                if (currentSection === 'statistics') {
                    newAchievements.forEach(achievement => {
                        const card = document.getElementById(`achievement-${achievement.id}`);
                        if (card) {
                            card.classList.add('achievement-unlocked');
                            setTimeout(() => {
                                card.classList.remove('achievement-unlocked');
                            }, 1000);
                        }
                    });
                }
                
                // –ü–æ–∫–∞–∑—É—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –Ω–æ–≤–µ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è
                newAchievements.forEach(achievement => {
                    showCatReward(achievement);
                });
            }
        }
        
        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–æ–∫–∞–∑—É –Ω–∞–≥–æ—Ä–æ–¥ –∫–æ—Ç–∏–∫–∞
        function showCatReward(achievement) {
            // –°—Ç–≤–æ—Ä—é—î–º–æ –µ–ª–µ–º–µ–Ω—Ç –Ω–∞–≥–æ—Ä–æ–¥–∏
            let catReward = document.createElement('div');
            catReward.className = 'cat-reward';
            
            catReward.innerHTML = `
                <span class="cat-reward-icon">${achievement.icon}</span>
                <h3>–ù–æ–≤–µ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è!</h3>
                <p>${achievement.title}</p>
                <p>${achievement.description}</p>
            `;
            
            document.body.appendChild(catReward);
            
            // –î–æ–¥–∞—î–º–æ –∑–≤—É–∫ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime);
                oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.2);
                oscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.4);
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 1);
            } catch(e) {
                console.log('Audio not supported');
            }
            
            // –ü–æ–∫–∞–∑—É—î–º–æ –∞–Ω—ñ–º–∞—Ü—ñ—é –∑ –∫–æ—Ç–∏–∫–æ–º
            const catCharacter = document.getElementById('catCharacter');
            catCharacter.classList.remove('cat-idle');
            catCharacter.classList.add('cat-bounce');
            
            // –ü–æ–∫–∞–∑—É—î–º–æ —Ä–µ–ø–ª—ñ–∫—É –∫–æ—Ç–∏–∫–∞
            showCatBubble('–ú—É—Ä—Ä! –í—ñ—Ç–∞—é –∑ –Ω–æ–≤–∏–º –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è–º!');
            
            // –ß–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥–∏ –ø—Ä–∏–±–∏—Ä–∞—î–º–æ –Ω–∞–≥–æ—Ä–æ–¥—É
            setTimeout(() => {
                catReward.style.opacity = '0';
                catReward.style.transform = 'translateX(-50%) scale(0.8)';
                setTimeout(() => {
                    document.body.removeChild(catReward);
                    catCharacter.classList.remove('cat-bounce');
                    catCharacter.classList.add('cat-idle');
                }, 500);
            }, 3000);
        }
        
        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–æ–∫–∞–∑—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
        function showNotification(message) {
            // –Ø–∫—â–æ –Ω–æ—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —â–µ –Ω–µ —ñ—Å–Ω—É—î, —Å—Ç–≤–æ—Ä—é—î–º–æ —ó—ó
            let notification = document.getElementById('notification');
            if (!notification) {
                notification = document.createElement('div');
                notification.id = 'notification';
                notification.style.position = 'fixed';
                notification.style.bottom = '20px';
                notification.style.left = '50%';
                notification.style.transform = 'translateX(-50%)';
                notification.style.background = 'var(--primary-color)';
                notification.style.color = 'white';
                notification.style.padding = '12px 20px';
                notification.style.borderRadius = '8px';
                notification.style.boxShadow = '0 4px 12px rgba(0,0,0,0.2)';
                notification.style.zIndex = '1000';
                notification.style.transition = 'all 0.3s ease';
                notification.style.opacity = '0';
                document.body.appendChild(notification);
            }
            
            notification.textContent = message;
            notification.style.opacity = '1';
            
            // –ß–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥–∏ —Ö–æ–≤–∞—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
            setTimeout(() => {
                notification.style.opacity = '0';
            }, 3000);
        }

        // –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–æ–≥–æ –¥–æ—Å–≤—ñ–¥—É
        document.addEventListener('keydown', function(event) {
            if (currentSection === 'training' && 
                document.getElementById('trainingArea').classList.contains('active')) {
                
                if (event.key === 'Escape') {
                    document.getElementById('trainingArea').classList.remove('active');
                } else if (event.key === ' ' && event.target.tagName !== 'INPUT') {
                    event.preventDefault();
                    const nextBtn = document.getElementById('nextBtn');
                    if (nextBtn.style.display !== 'none') {
                        nextProblem();
                    }
                }
            }
        });

        // –ê–≤—Ç–æ—Ñ–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –≤–≤–µ–¥–µ–Ω–Ω—è
        function focusInput() {
            const input = document.getElementById('answerInput');
            if (input) {
                input.focus();
            }
        }

        // –ü–æ–∫—Ä–∞—â–µ–Ω–∞ –ø—ñ–¥–∫–∞–∑–∫–∞ –¥–ª—è —Å–∫–ª–∞–¥–Ω—ñ—à–∏—Ö —Ç–∞–±–ª–∏—Ü—å
        function getAdvancedHint(a, b) {
            const strategies = {
                6: (other) => `6 √ó ${other} = (5 √ó ${other}) + ${other} = ${5 * other} + ${other} = ${6 * other}`,
                7: (other) => `7 √ó ${other} = (5 √ó ${other}) + (2 √ó ${other}) = ${5 * other} + ${2 * other} = ${7 * other}`,
                8: (other) => `8 √ó ${other} = (4 √ó ${other}) √ó 2 = ${4 * other} √ó 2 = ${8 * other}`,
                9: (other) => `9 √ó ${other} = (10 √ó ${other}) - ${other} = ${10 * other} - ${other} = ${9 * other}`
            };
            
            if (strategies[a]) {
                return strategies[a](b);
            } else if (strategies[b]) {
                return strategies[b](a);
            }
            
            return `${a} √ó ${b} = ${a * b}`;
        }

        // –ó–≤—É–∫–æ–≤–∏–π –∑–≤–æ—Ä–æ—Ç–Ω–∏–π –∑–≤'—è–∑–æ–∫ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
        function playSuccessSound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime); // –î–æ
            oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1); // –ú—ñ
            oscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.2); // –°–æ–ª—å
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.3);
        }

        function playErrorSound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = 200;
            oscillator.type = 'sawtooth';
            
            gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.5);
        }
        
        // –ú—ñ–Ω—ñ-–≥—Ä–∞ "–õ–æ–≤–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å"
        function initCatchGame() {
            // –û—á–∏—Å—Ç–∏–º–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—é –≥—Ä—É, —è–∫—â–æ –≤–æ–Ω–∞ –∑–∞–ø—É—â–µ–Ω–∞
            if (catchGameData.interval) {
                clearInterval(catchGameData.interval);
                catchGameData.interval = null;
            }
            
            // –û–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            document.getElementById('catchGameScore').textContent = '–†–∞—Ö—É–Ω–æ–∫: 0';
            document.getElementById('catchGameTimer').textContent = '30—Å';
            document.getElementById('catchGameProblem').textContent = '–ù–∞—Ç–∏—Å–Ω–∏ "–ü–æ—á–∞—Ç–∏ –≥—Ä—É"';
            
            const optionsContainer = document.getElementById('catchGameOptions');
            optionsContainer.innerHTML = '';
            
            // –°–∫–∏–¥–∞—î–º–æ –¥–∞–Ω—ñ –≥—Ä–∏
            catchGameData.score = 0;
            catchGameData.timer = 30;
        }
        
        function startCatchGame() {
            // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ –¥–∞–Ω—ñ –≥—Ä–∏
            catchGameData.score = 0;
            catchGameData.timer = 30;
            
            // –í—ñ–¥—Å—Ç–µ–∂—É—î–º–æ –ø–æ—á–∞—Ç–æ–∫ –≥—Ä–∏
            trackAction('catch_game_start');
            
            // –û–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            document.getElementById('catchGameScore').textContent = '–†–∞—Ö—É–Ω–æ–∫: 0';
            document.getElementById('catchGameTimer').textContent = '30—Å';
            
            // –ì–µ–Ω–µ—Ä—É—î–º–æ –ø–µ—Ä—à–µ –ø–∏—Ç–∞–Ω–Ω—è
            generateCatchGameQuestion();
            
            // –ó–∞–ø—É—Å–∫–∞—î–º–æ —Ç–∞–π–º–µ—Ä
            if (catchGameData.interval) {
                clearInterval(catchGameData.interval);
            }
            
            catchGameData.interval = setInterval(() => {
                catchGameData.timer--;
                document.getElementById('catchGameTimer').textContent = catchGameData.timer + '—Å';
                
                if (catchGameData.timer <= 0) {
                    endCatchGame();
                }
            }, 1000);
        }
        
        function generateCatchGameQuestion() {
            // –ì–µ–Ω–µ—Ä—É—î–º–æ –≤–∏–ø–∞–¥–∫–æ–≤–∏–π –ø—Ä–∏–∫–ª–∞–¥
            const a = Math.floor(Math.random() * 10) + 1;
            const b = Math.floor(Math.random() * 10) + 1;
            const correctAnswer = a * b;
            
            // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –ø–æ—Ç–æ—á–Ω–µ –ø–∏—Ç–∞–Ω–Ω—è
            catchGameData.currentProblem = { a, b, answer: correctAnswer };
            
            // –î–æ–¥–∞—î–º–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ –æ—Å–æ–±–ª–∏–≤–æ—Å—Ç–µ–π –∫–æ—Ç—ñ–≤
            let problemText = `${a} √ó ${b} = ?`;
            
            if (document.body.classList.contains('cat-theme') || document.getElementById('catTasksToggle').checked) {
                // –í–∏–∑–Ω–∞—á–∞—î–º–æ —Ç–∏–ø –∫–æ—Ç—è—á–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ —á–∏—Å–µ–ª
                if (a === 4 || b === 4) {
                    // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –ª–∞–ø–∫–∏
                    problemText = `–£ ${a === 4 ? b : a} –∫–æ—Ç–∏–∫—ñ–≤ –ø–æ 4 –ª–∞–ø–∫–∏. –°–∫—ñ–ª—å–∫–∏ –≤—Å—å–æ–≥–æ –ª–∞–ø–æ–∫?`;
                } else if (a === 2 || b === 2) {
                    // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –≤—É—à–∫–∞
                    problemText = `–£ ${a === 2 ? b : a} –∫–æ—Ç–∏–∫—ñ–≤ –ø–æ 2 –≤—É—à–∫–∞. –°–∫—ñ–ª—å–∫–∏ –≤—Å—å–æ–≥–æ –≤—É—à–æ–∫?`;
                } else if (a === 1 || b === 1) {
                    // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ö–≤–æ—Å—Ç–∏–∫–∏
                    problemText = `–£ ${Math.max(a, b)} –∫–æ—Ç–∏–∫—ñ–≤ –ø–æ 1 —Ö–≤–æ—Å—Ç–∏–∫—É. –°–∫—ñ–ª—å–∫–∏ –≤—Å—å–æ–≥–æ —Ö–≤–æ—Å—Ç–∏–∫—ñ–≤?`;
                } else {
                    // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Å–º–∞–∫–æ–ª–∏–∫–∏
                    problemText = `${a} –∫–æ—Ç–∏–∫—ñ–≤ –æ—Ç—Ä–∏–º–∞–ª–∏ –ø–æ ${b} —Å–º–∞–∫–æ–ª–∏–∫—ñ–≤. –°–∫—ñ–ª—å–∫–∏ –≤—Å—å–æ–≥–æ —Å–º–∞–∫–æ–ª–∏–∫—ñ–≤?`;
                }
            }
            
            // –û–Ω–æ–≤–ª—é—î–º–æ —Ç–µ–∫—Å—Ç –ø—Ä–æ–±–ª–µ–º–∏
            document.getElementById('catchGameProblem').innerHTML = problemText;
            
            // –ì–µ–Ω–µ—Ä—É—î–º–æ –≤–∞—Ä—ñ–∞–Ω—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π
            const options = generateAnswerOptions(correctAnswer);
            
            // –û–Ω–æ–≤–ª—é—î–º–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑ –≤–∞—Ä—ñ–∞–Ω—Ç–∞–º–∏
            const optionsContainer = document.getElementById('catchGameOptions');
            optionsContainer.innerHTML = '';
            
            // –ü–µ—Ä–µ–º—ñ—à—É—î–º–æ –≤–∞—Ä—ñ–∞–Ω—Ç–∏
            shuffleArray(options);
            
            // –î–æ–¥–∞—î–º–æ –≤–∞—Ä—ñ–∞–Ω—Ç–∏ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É
            options.forEach(option => {
                const button = document.createElement('button');
                button.className = 'answer-option';
                button.textContent = option;
                
                button.addEventListener('click', () => {
                    checkCatchGameAnswer(option);
                });
                
                optionsContainer.appendChild(button);
            });
        }
        
        function generateAnswerOptions(correctAnswer) {
            const options = [correctAnswer];
            
            // –ì–µ–Ω–µ—Ä—É—î–º–æ 3 –Ω–µ–≤—ñ—Ä–Ω—ñ –≤–∞—Ä—ñ–∞–Ω—Ç–∏
            while (options.length < 4) {
                // –ì–µ–Ω–µ—Ä—É—î–º–æ —á–∏—Å–ª–æ –≤ –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ ¬±20% –≤—ñ–¥ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ, –∞–ª–µ –Ω–µ –º–µ–Ω—à–µ 1
                let rangeMin = Math.max(1, Math.floor(correctAnswer * 0.8));
                let rangeMax = Math.ceil(correctAnswer * 1.2);
                
                // –Ø–∫—â–æ –ø—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –º–∞–ª–∞, –∑–±—ñ–ª—å—à—É—î–º–æ –¥—ñ–∞–ø–∞–∑–æ–Ω
                if (correctAnswer < 10) {
                    rangeMin = 1;
                    rangeMax = 20;
                }
                
                const wrongAnswer = Math.floor(Math.random() * (rangeMax - rangeMin + 1)) + rangeMin;
                
                // –î–æ–¥–∞—î–º–æ —Ç—ñ–ª—å–∫–∏ —É–Ω—ñ–∫–∞–ª—å–Ω—ñ –≤–∞—Ä—ñ–∞–Ω—Ç–∏
                if (wrongAnswer !== correctAnswer && !options.includes(wrongAnswer)) {
                    options.push(wrongAnswer);
                }
            }
            
            return options;
        }
        
        function checkCatchGameAnswer(selectedAnswer) {
            const correctAnswer = catchGameData.currentProblem.answer;
            const isCorrect = parseInt(selectedAnswer) === correctAnswer;
            
            // –í—ñ–¥—Å—Ç–µ–∂—É—î–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å —É –≥—Ä—ñ
            trackAction('catch_game_answer', {
                problem: `${catchGameData.currentProblem.a} √ó ${catchGameData.currentProblem.b}`,
                selectedAnswer,
                correctAnswer,
                isCorrect
            });
            
            if (isCorrect) {
                // –ü—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å
                catchGameData.score++;
                document.getElementById('catchGameScore').textContent = '–†–∞—Ö—É–Ω–æ–∫: ' + catchGameData.score;
                
                // –ï—Ñ–µ–∫—Ç –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
                const problem = document.getElementById('catchGameProblem');
                problem.textContent = '‚úì –ü—Ä–∞–≤–∏–ª—å–Ω–æ!';
                problem.style.color = 'var(--success-color)';
                
                // –û–Ω–æ–≤–ª—é—î–º–æ —Ä–∞—Ö—É–Ω–æ–∫ —É —Å—Ç–∞—Ç–∏—Å—Ç–∏—Ü—ñ
                if (!stats.gameScores) stats.gameScores = {};
                stats.gameScores.catchGame = Math.max(catchGameData.score, stats.gameScores.catchGame || 0);
                saveStats();
                checkAchievements();
                
                // –ó–∞—Ç—Ä–∏–º–∫–∞ –ø–µ—Ä–µ–¥ –Ω–∞—Å—Ç—É–ø–Ω–∏–º –ø–∏—Ç–∞–Ω–Ω—è–º
                setTimeout(() => {
                    problem.style.color = '';
                    generateCatchGameQuestion();
                }, 1000);
            } else {
                // –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å
                const problem = document.getElementById('catchGameProblem');
                problem.textContent = `‚úó ${catchGameData.currentProblem.a} √ó ${catchGameData.currentProblem.b} = ${correctAnswer}`;
                problem.style.color = 'var(--secondary-color)';
                
                // –ó–∞—Ç—Ä–∏–º–∫–∞ –ø–µ—Ä–µ–¥ –Ω–∞—Å—Ç—É–ø–Ω–∏–º –ø–∏—Ç–∞–Ω–Ω—è–º
                setTimeout(() => {
                    problem.style.color = '';
                    generateCatchGameQuestion();
                }, 1500);
            }
        }
        
        function endCatchGame() {
            clearInterval(catchGameData.interval);
            catchGameData.interval = null;
            
            const problem = document.getElementById('catchGameProblem');
            problem.textContent = `–ì—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –¢–≤—ñ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${catchGameData.score}`;
            
            const optionsContainer = document.getElementById('catchGameOptions');
            optionsContainer.innerHTML = '';
            
            // –í—ñ–¥—Å—Ç–µ–∂—É—î–º–æ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –≥—Ä–∏
            trackAction('catch_game_end', { score: catchGameData.score });
            
            if (catchGameData.score > 0) {
                // –û–Ω–æ–≤–ª—é—î–º–æ —Ä–∞—Ö—É–Ω–æ–∫ —É —Å—Ç–∞—Ç–∏—Å—Ç–∏—Ü—ñ, —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ
                if (!stats.gameScores) stats.gameScores = {};
                stats.gameScores.catchGame = Math.max(catchGameData.score, stats.gameScores.catchGame || 0);
                saveStats();
                checkAchievements();
            }
        }
        
        // –ì—Ä–∞ "–ü–∞—Ä–Ω—ñ –∫–∞—Ä—Ç–∫–∏"
        function setMemoryGameLevel(level) {
            // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –∞–∫—Ç–∏–≤–Ω–∏–π —Ä—ñ–≤–µ–Ω—å
            document.querySelectorAll('.level-button').forEach(button => {
                button.classList.remove('active');
            });
            document.querySelector(`.level-button[data-level="${level}"]`).classList.add('active');
            
            memoryGameData.level = level;
            
            // –í—ñ–¥—Å—Ç–µ–∂—É—î–º–æ –∑–º—ñ–Ω—É —Ä—ñ–≤–Ω—è
            trackAction('memory_game_level_change', { level });
            
            // –ù–∞–ª–∞—à—Ç–æ–≤—É—î–º–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –¥–ª—è —Ä—ñ–≤–Ω—è
            switch(level) {
                case 'easy':
                    memoryGameData.rows = 2;
                    memoryGameData.cols = 3;
                    memoryGameData.timer = 60;
                    break;
                case 'medium':
                    memoryGameData.rows = 3;
                    memoryGameData.cols = 4;
                    memoryGameData.timer = 90;
                    break;
                case 'hard':
                    memoryGameData.rows = 4;
                    memoryGameData.cols = 4;
                    memoryGameData.timer = 120;
                    break;
            }
            
            document.getElementById('memoryGameTimer').textContent = memoryGameData.timer + '—Å';
            document.getElementById('memoryGameScore').textContent = `–ü–∞—Ä–∏: 0/${(memoryGameData.rows * memoryGameData.cols) / 2}`;
            resetMemoryGame();
        }
        
        function resetMemoryGame() {
            // –°–∫–∏–¥–∞—î–º–æ –¥–∞–Ω—ñ –≥—Ä–∏
            memoryGameData.cards = [];
            memoryGameData.flippedCards = [];
            memoryGameData.matchedPairs = 0;
            memoryGameData.totalPairs = (memoryGameData.rows * memoryGameData.cols) / 2;
            memoryGameData.moves = 0;
            memoryGameData.isLocked = false;
            
            // –û—á–∏—â–∞—î–º–æ —ñ–≥—Ä–æ–≤–µ –ø–æ–ª–µ
            const boardElement = document.getElementById('memoryBoard');
            boardElement.innerHTML = '';
            
            // –ù–∞–ª–∞—à—Ç–æ–≤—É—î–º–æ –≤–∏–≥–ª—è–¥ –¥–æ—à–∫–∏
            boardElement.style.gridTemplateColumns = `repeat(${memoryGameData.cols}, 1fr)`;
            boardElement.style.gridTemplateRows = `repeat(${memoryGameData.rows}, 1fr)`;
            
            // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –ø–æ—á–∞—Ç–∫–æ–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            document.getElementById('memoryMoves').textContent = '–•–æ–¥–∏: 0';
            document.getElementById('memoryMatches').textContent = '–ü–∞—Ä–∏: 0';
            
            document.getElementById('memoryBoard').innerHTML = `
                <div style="grid-column: 1 / -1; padding: 50px 0; text-align: center; font-size: 1.2em;">
                    –ù–∞—Ç–∏—Å–Ω–∏ "–ü–æ—á–∞—Ç–∏ –≥—Ä—É" —â–æ–± —Ä–æ–∑–ø–æ—á–∞—Ç–∏
                </div>
            `;
        }
        
        function startMemoryGame() {
            // –Ø–∫—â–æ —Ç–∞–π–º–µ—Ä —É–∂–µ –∑–∞–ø—É—â–µ–Ω–æ, –∑—É–ø–∏–Ω—è—î–º–æ –π–æ–≥–æ
            if (memoryGameData.interval) {
                clearInterval(memoryGameData.interval);
                memoryGameData.interval = null;
            }
            
            // –í—ñ–¥—Å—Ç–µ–∂—É—î–º–æ –ø–æ—á–∞—Ç–æ–∫ –≥—Ä–∏
            trackAction('memory_game_start', { level: memoryGameData.level });
            
            // –°–∫–∏–¥–∞—î–º–æ –¥–∞–Ω—ñ –≥—Ä–∏
            memoryGameData.flippedCards = [];
            memoryGameData.matchedPairs = 0;
            memoryGameData.moves = 0;
            memoryGameData.isLocked = false;
            
            // –°—Ç–≤–æ—Ä—é—î–º–æ –∫–∞—Ä—Ç–∏
            createMemoryCards();
            
            // –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            document.getElementById('memoryMoves').textContent = '–•–æ–¥–∏: 0';
            document.getElementById('memoryMatches').textContent = '–ü–∞—Ä–∏: 0';
            
            // –ó–∞–ø—É—Å–∫–∞—î–º–æ —Ç–∞–π–º–µ—Ä
            memoryGameData.timer = memoryGameData.level === 'easy' ? 60 : (memoryGameData.level === 'medium' ? 90 : 120);
            document.getElementById('memoryGameTimer').textContent = memoryGameData.timer + '—Å';
            document.getElementById('memoryGameScore').textContent = `–ü–∞—Ä–∏: 0/${memoryGameData.totalPairs}`;
            
            memoryGameData.interval = setInterval(() => {
                memoryGameData.timer--;
                document.getElementById('memoryGameTimer').textContent = memoryGameData.timer + '—Å';
                
                if (memoryGameData.timer <= 0) {
                    endMemoryGame(false);
                }
            }, 1000);
        }
        
        function createMemoryCards() {
            const boardElement = document.getElementById('memoryBoard');
            boardElement.innerHTML = '';
            
            // –í–∏–∑–Ω–∞—á–∞—î–º–æ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–∞—Ä
            const totalPairs = (memoryGameData.rows * memoryGameData.cols) / 2;
            memoryGameData.totalPairs = totalPairs;
            
            // –°—Ç–≤–æ—Ä—é—î–º–æ –º–∞—Å–∏–≤ –∫–∞—Ä—Ç–æ–∫ (–ø–∞—Ä–∏: –∑–∞–≤–¥–∞–Ω–Ω—è —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å)
            let cards = [];
            let usedProblems = new Set();
            
            // –í–∏–∑–Ω–∞—á–∞—î–º–æ, —á–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∫–æ—Ç—è—á—É —Ç–µ–º–∞—Ç–∏–∫—É
            const useCatTheme = document.body.classList.contains('cat-theme') || 
                                document.getElementById('catTasksToggle').checked;
            
            // –ì–µ–Ω–µ—Ä—É—î–º–æ —É–Ω—ñ–∫–∞–ª—å–Ω—ñ –ø–∞—Ä–∏ –º–Ω–æ–∂–µ–Ω–Ω—è
            while (cards.length < totalPairs * 2) {
                let a = Math.floor(Math.random() * 10) + 1;
                let b = Math.floor(Math.random() * 10) + 1;
                
                // –£–Ω–∏–∫–∞—î–º–æ –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤
                const problemKey = `${a}x${b}`;
                const reverseProblemKey = `${b}x${a}`;
                
                if (!usedProblems.has(problemKey) && !usedProblems.has(reverseProblemKey)) {
                    usedProblems.add(problemKey);
                    
                    // –î–æ–¥–∞—î–º–æ –∫–æ—Ç—è—á–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç, —è–∫—â–æ –≤–∏–±—Ä–∞–Ω–∞ –∫–æ—Ç—è—á–∞ —Ç–µ–º–∞
                    let problemContent = `${a} √ó ${b}`;
                    
                    if (useCatTheme && Math.random() > 0.5) {
                        const catEmojis = ['üê±', 'üò∫', 'üò∏', 'üòª', 'üêà'];
                        const randomEmoji = catEmojis[Math.floor(Math.random() * catEmojis.length)];
                        problemContent = `${randomEmoji} ${a} √ó ${b}`;
                    }
                    
                    // –î–æ–¥–∞—î–º–æ –∫–∞—Ä—Ç—É –∑–∞–≤–¥–∞–Ω–Ω—è
                    cards.push({
                        id: cards.length,
                        pairId: cards.length / 2,
                        type: 'problem',
                        content: problemContent,
                        value: a * b
                    });
                    
                    // –î–æ–¥–∞—î–º–æ –∫–∞—Ä—Ç—É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
                    let answerContent = `${a * b}`;
                    
                    if (useCatTheme && Math.random() > 0.7) {
                        // –î–æ–¥–∞—î–º–æ –∫–æ—Ç—è—á—ñ "—Å–ª—ñ–¥–∏" –Ω–∞–≤–∫–æ–ª–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
                        answerContent = `üêæ ${a * b} üêæ`;
                    }
                    
                    cards.push({
                        id: cards.length,
                        pairId: Math.floor(cards.length / 2),
                        type: 'answer',
                        content: answerContent,
                        value: a * b
                    });
                }
            }
            
            // –ü–µ—Ä–µ–º—ñ—à—É—î–º–æ –∫–∞—Ä—Ç–∏
            shuffleArray(cards);
            memoryGameData.cards = cards;
            
            // –î–æ–¥–∞—î–º–æ –∫–∞—Ä—Ç–∏ –Ω–∞ –¥–æ—à–∫—É
            cards.forEach(card => {
                const cardElement = document.createElement('div');
                cardElement.className = 'memory-card';
                cardElement.dataset.id = card.id;
                cardElement.dataset.pairId = card.pairId;
                cardElement.dataset.value = card.value;
                
                cardElement.innerHTML = `
                    <div class="memory-card-front">${card.content}</div>
                    <div class="memory-card-back">?</div>
                `;
                
                cardElement.addEventListener('click', () => flipCard(cardElement));
                boardElement.appendChild(cardElement);
            });
        }
        
        function flipCard(cardElement) {
            // –Ü–≥–Ω–æ—Ä—É—î–º–æ –∫–ª—ñ–∫–∏, —è–∫—â–æ:
            // - –≥—Ä–∞ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∞ (–ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–∞—Ä–∏)
            // - –∫–∞—Ä—Ç–∞ –≤–∂–µ –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç–∞ –∞–±–æ –≤–∂–µ –∑–Ω–∞–π–¥–µ–Ω–∞
            // - –≤–∂–µ –≤–∏–±—Ä–∞–Ω–æ –¥–≤—ñ –∫–∞—Ä—Ç–∏
            if (
                memoryGameData.isLocked || 
                cardElement.classList.contains('flipped') || 
                cardElement.classList.contains('matched') || 
                memoryGameData.flippedCards.length >= 2
            ) {
                return;
            }
            
            // –ü–µ—Ä–µ–≤–µ—Ä—Ç–∞—î–º–æ –∫–∞—Ä—Ç—É
            cardElement.classList.add('flipped');
            
            // –î–æ–¥–∞—î–º–æ –∫–∞—Ä—Ç—É –¥–æ —Å–ø–∏—Å–∫—É –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç–∏—Ö
            memoryGameData.flippedCards.push(cardElement);
            
            // –Ø–∫—â–æ –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç–æ –¥–≤—ñ –∫–∞—Ä—Ç–∏, –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –≤–æ–Ω–∏ —É—Ç–≤–æ—Ä—é—é—Ç—å –ø–∞—Ä—É
            if (memoryGameData.flippedCards.length === 2) {
                // –ó–±—ñ–ª—å—à—É—î–º–æ –ª—ñ—á–∏–ª—å–Ω–∏–∫ —Ö–æ–¥—ñ–≤
                memoryGameData.moves++;
                document.getElementById('memoryMoves').textContent = `–•–æ–¥–∏: ${memoryGameData.moves}`;
                
                // –ë–ª–æ–∫—É—î–º–æ –≥—Ä—É –Ω–∞ —á–∞—Å –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏
                memoryGameData.isLocked = true;
                
                const card1 = memoryGameData.flippedCards[0];
                const card2 = memoryGameData.flippedCards[1];
                
                // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –æ–¥–Ω–∞–∫–æ–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è —É –∫–∞—Ä—Ç
                if (card1.dataset.value === card2.dataset.value) {
                    // –ü–∞—Ä–∞ –∑–Ω–∞–π–¥–µ–Ω–∞
                    setTimeout(() => {
                        card1.classList.add('matched', 'match-animation');
                        card2.classList.add('matched', 'match-animation');
                        
                        // –ó–±—ñ–ª—å—à—É—î–º–æ –ª—ñ—á–∏–ª—å–Ω–∏–∫ –∑–Ω–∞–π–¥–µ–Ω–∏—Ö –ø–∞—Ä
                        memoryGameData.matchedPairs++;
                        document.getElementById('memoryMatches').textContent = `–ü–∞—Ä–∏: ${memoryGameData.matchedPairs}`;
                        document.getElementById('memoryGameScore').textContent = `–ü–∞—Ä–∏: ${memoryGameData.matchedPairs}/${memoryGameData.totalPairs}`;
                        
                        // –ü—Ä–æ–≥—Ä–∞—î–º–æ –∑–≤—É–∫ —É—Å–ø—ñ—Ö—É
                        try {
                            playSuccessSound();
                        } catch(e) {
                            console.log('Audio not supported');
                        }
                        
                        // –ü–æ–∫–∞–∑—É—î–º–æ –∫–æ—Ç—è—á—É —Ä–µ–∞–∫—Ü—ñ—é, —è–∫—â–æ –≤–∏–±—Ä–∞–Ω–∞ –∫–æ—Ç—è—á–∞ —Ç–µ–º–∞
                        if (document.body.classList.contains('cat-theme') || document.getElementById('catTasksToggle').checked) {
                            const catReactions = catPhrases.correct;
                            const randomReaction = catReactions[Math.floor(Math.random() * catReactions.length)];
                            showCatBubble(randomReaction);
                        }
                        
                        // –û—á–∏—â–∞—î–º–æ –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç—ñ –∫–∞—Ä—Ç–∏
                        memoryGameData.flippedCards = [];
                        memoryGameData.isLocked = false;
                        
                        // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –≤—Å—ñ –ø–∞—Ä–∏ –∑–Ω–∞–π–¥–µ–Ω—ñ
                        if (memoryGameData.matchedPairs === memoryGameData.totalPairs) {
                            endMemoryGame(true);
                        }
                    }, 500);
                } else {
                    // –ü–∞—Ä–∞ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∞
                    setTimeout(() => {
                        card1.classList.add('wrong-animation');
                        card2.classList.add('wrong-animation');
                        
                        // –ß–µ—Ä–µ–∑ 0.5 —Å–µ–∫—É–Ω–¥ –ø—Ä–∏–±–∏—Ä–∞—î–º–æ –∞–Ω—ñ–º–∞—Ü—ñ—é —Ç—Ä—è—Å–∫–∏
                        setTimeout(() => {
                            card1.classList.remove('wrong-animation');
                            card2.classList.remove('wrong-animation');
                            card1.classList.remove('flipped');
                            card2.classList.remove('flipped');
                            
                            memoryGameData.flippedCards = [];
                            memoryGameData.isLocked = false;
                        }, 600);
                        
                        // –ü—Ä–æ–≥—Ä–∞—î–º–æ –∑–≤—É–∫ –ø–æ–º–∏–ª–∫–∏
                        try {
                            playErrorSound();
                        } catch(e) {
                            console.log('Audio not supported');
                        }
                        
                        // –ü–æ–∫–∞–∑—É—î–º–æ –∫–æ—Ç—è—á—É —Ä–µ–∞–∫—Ü—ñ—é, —è–∫—â–æ –≤–∏–±—Ä–∞–Ω–∞ –∫–æ—Ç—è—á–∞ —Ç–µ–º–∞
                        if (document.body.classList.contains('cat-theme') || document.getElementById('catTasksToggle').checked) {
                            const catReactions = catPhrases.incorrect;
                            const randomReaction = catReactions[Math.floor(Math.random() * catReactions.length)];
                            showCatBubble(randomReaction);
                        }
                    }, 500);
                }
            }
        }
        
        function endMemoryGame(isWin) {
            // –ó—É–ø–∏–Ω—è—î–º–æ —Ç–∞–π–º–µ—Ä
            clearInterval(memoryGameData.interval);
            memoryGameData.interval = null;
            
            // –ë–ª–æ–∫—É—î–º–æ –≤—Å—ñ –∫–∞—Ä—Ç–∏
            memoryGameData.isLocked = true;
            
            // –í—ñ–¥—Å—Ç–µ–∂—É—î–º–æ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –≥—Ä–∏
            trackAction('memory_game_end', {
                level: memoryGameData.level,
                isWin,
                moves: memoryGameData.moves,
                timeRemaining: memoryGameData.timer
            });
            
            if (isWin) {
                showNotification(`üéâ –í—ñ—Ç–∞—î–º–æ! –¢–∏ –∑–Ω–∞–π—à–æ–≤ —É—Å—ñ –ø–∞—Ä–∏ –∑–∞ ${memoryGameData.moves} —Ö–æ–¥—ñ–≤!`);
                
                // –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                updateMemoryGameStats(true);
                
                // –Ø–∫—â–æ –≥—Ä–∞–≤–µ—Ü—å –∑–Ω–∞–π—à–æ–≤ —É—Å—ñ –ø–∞—Ä–∏ –∑–∞ –º–µ–Ω—à–µ –Ω—ñ–∂ 20 —Ö–æ–¥—ñ–≤
                if (memoryGameData.moves < 20) {
                    stats.gameScores.memoryGamePerfect = true;
                    saveStats();
                    checkAchievements();
                }
            } else {
                showNotification(`‚è±Ô∏è –ß–∞—Å –≤–∏–π—à–æ–≤! –ó–Ω–∞–π–¥–µ–Ω–æ ${memoryGameData.matchedPairs} –∑ ${memoryGameData.totalPairs} –ø–∞—Ä.`);
                
                // –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É, –∞–ª–µ –Ω–µ —Ä–∞—Ö—É—î–º–æ –ø–µ—Ä–µ–º–æ–≥—É
                updateMemoryGameStats(false);
            }
        }
        
        function updateMemoryGameStats(isWin) {
            if (isWin) {
                switch (memoryGameData.level) {
                    case 'easy':
                        stats.gameScores.memoryGameEasy = true;
                        break;
                    case 'medium':
                        stats.gameScores.memoryGameMedium = true;
                        break;
                    case 'hard':
                        stats.gameScores.memoryGameHard = true;
                        break;
                }
                
                saveStats();
                checkAchievements();
            }
        }
        
        // –ì—Ä–∞ "–ù–∞–≥–æ–¥—É–π –∫–æ—Ç–∏–∫–∞"
        function initCatGame() {
            // –û—á–∏—Å—Ç–∏–º–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—é –≥—Ä—É, —è–∫—â–æ –≤–æ–Ω–∞ –∑–∞–ø—É—â–µ–Ω–∞
            if (catGameData.interval) {
                clearInterval(catGameData.interval);
                catGameData.interval = null;
            }
            
            // –û–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            document.getElementById('catGameScore').textContent = '–°–º–∞–∫–æ–ª–∏–∫–∏: 0';
            document.getElementById('catGameTimer').textContent = '30—Å';
            document.getElementById('catGameProblem').textContent = '–ù–∞—Ç–∏—Å–Ω–∏ "–ü–æ—á–∞—Ç–∏ –≥—Ä—É" —â–æ–± –ø–æ–≥–æ–¥—É–≤–∞—Ç–∏ –∫–æ—Ç–∏–∫–∞';
            document.getElementById('catGameInput').value = '';
            document.getElementById('catFood').style.display = 'none';
            document.getElementById('catThoughtBubble').style.display = 'none';
            
            // –°–∫–∏–¥–∞—î–º–æ –¥–∞–Ω—ñ –≥—Ä–∏
            catGameData.score = 0;
            catGameData.timer = 30;
            catGameData.isAnimating = false;
        }
        
        function startCatGame() {
            // –û—á–∏—â–∞—î–º–æ –ø–æ–ª—è
            document.getElementById('catGameInput').value = '';
            document.getElementById('catGameFeedback').textContent = '';
            
            // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ –¥–∞–Ω—ñ –≥—Ä–∏
            catGameData.score = 0;
            catGameData.timer = 30;
            
            // –í—ñ–¥—Å—Ç–µ–∂—É—î–º–æ –ø–æ—á–∞—Ç–æ–∫ –≥—Ä–∏
            trackAction('cat_game_start');
            
            // –û–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            document.getElementById('catGameScore').textContent = '–°–º–∞–∫–æ–ª–∏–∫–∏: 0';
            document.getElementById('catGameTimer').textContent = '30—Å';
            
            // –ü–æ–∫–∞–∑—É—î–º–æ –¥—É–º–∫–∏ –∫–æ—Ç–∏–∫–∞
            const catThought = document.getElementById('catThoughtBubble');
            catThought.style.display = 'block';
            document.getElementById('catThoughtText').textContent = '–ú—è—É! –Ø –≥–æ–ª–æ–¥–Ω–∏–π!';
            
            // –ì–µ–Ω–µ—Ä—É—î–º–æ –ø–µ—Ä—à–µ –ø–∏—Ç–∞–Ω–Ω—è
            generateCatGameQuestion();
            
            // –§–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –≤–≤–µ–¥–µ–Ω–Ω—è
            document.getElementById('catGameInput').focus();
            
            // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫ –∫–ª–∞–≤—ñ—à—ñ Enter
            document.getElementById('catGameInput').addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    checkCatGameAnswer();
                }
            });
            
            // –ó–∞–ø—É—Å–∫–∞—î–º–æ —Ç–∞–π–º–µ—Ä
            if (catGameData.interval) {
                clearInterval(catGameData.interval);
            }
            
            catGameData.interval = setInterval(() => {
                catGameData.timer--;
                document.getElementById('catGameTimer').textContent = catGameData.timer + '—Å';
                
                if (catGameData.timer <= 0) {
                    endCatGame();
                }
            }, 1000);
        }
        
        function generateCatGameQuestion() {
            // –ì–µ–Ω–µ—Ä—É—î–º–æ –≤–∏–ø–∞–¥–∫–æ–≤–µ –ø–∏—Ç–∞–Ω–Ω—è –º–Ω–æ–∂–µ–Ω–Ω—è
            const a = Math.floor(Math.random() * 10) + 1;
            const b = Math.floor(Math.random() * 10) + 1;
            const correctAnswer = a * b;
            
            // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –ø–æ—Ç–æ—á–Ω–µ –ø–∏—Ç–∞–Ω–Ω—è
            catGameData.currentProblem = { a, b, answer: correctAnswer };
            
            // –í–∏–∑–Ω–∞—á–∞—î–º–æ —Ç–∏–ø –ø–∏—Ç–∞–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ —á–∏—Å–µ–ª (–¥–ª—è —É–∑–≥–æ–¥–∂–µ–Ω–æ—Å—Ç—ñ –∑ –∞–Ω–∞—Ç–æ–º—ñ—î—é –∫–æ—Ç—ñ–≤)
            let questionText;
            
            if (a === 4 || b === 4) {
                // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –ª–∞–ø–∫–∏
                questionText = `–£ ${a === 4 ? b : a} –∫–æ—Ç–∏–∫—ñ–≤ –ø–æ 4 –ª–∞–ø–∫–∏. –°–∫—ñ–ª—å–∫–∏ –≤—Å—å–æ–≥–æ –ª–∞–ø–æ–∫?`;
            } else if (a === 2 || b === 2) {
                // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –≤—É—à–∫–∞
                questionText = `–£ ${a === 2 ? b : a} –∫–æ—Ç–∏–∫—ñ–≤ –ø–æ 2 –≤—É—à–∫–∞. –°–∫—ñ–ª—å–∫–∏ –≤—Å—å–æ–≥–æ –≤—É—à–æ–∫?`;
            } else if (a === 1 || b === 1) {
                // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ö–≤–æ—Å—Ç–∏–∫–∏
                questionText = `–£ ${Math.max(a, b)} –∫–æ—Ç–∏–∫—ñ–≤ –ø–æ 1 —Ö–≤–æ—Å—Ç–∏–∫—É. –°–∫—ñ–ª—å–∫–∏ –≤—Å—å–æ–≥–æ —Ö–≤–æ—Å—Ç–∏–∫—ñ–≤?`;
            } else {
                // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Å–º–∞–∫–æ–ª–∏–∫–∏
                questionText = `${a} –∫–æ—Ç–∏–∫—ñ–≤ –æ—Ç—Ä–∏–º–∞–ª–∏ –ø–æ ${b} —Å–º–∞–∫–æ–ª–∏–∫—ñ–≤. –°–∫—ñ–ª—å–∫–∏ –≤—Å—å–æ–≥–æ —Å–º–∞–∫–æ–ª–∏–∫—ñ–≤?`;
            }
            
            // –û–Ω–æ–≤–ª—é—î–º–æ —Ç–µ–∫—Å—Ç –ø–∏—Ç–∞–Ω–Ω—è
            document.getElementById('catGameProblem').textContent = questionText;
            
            // –û–Ω–æ–≤–ª—é—î–º–æ –¥—É–º–∫–∏ –∫–æ—Ç–∏–∫–∞
            const catThoughts = [
                "–ú—è—É, –∑–¥–∞—î—Ç—å—Å—è —è –∑–Ω–∞—é –≤—ñ–¥–ø–æ–≤—ñ–¥—å...",
                "–ú—É—Ä-–º—É—Ä, —Ü–µ —Å–∫–ª–∞–¥–Ω–æ...",
                "–ù—è–≤! –î–∞–π –º–µ–Ω—ñ –ø–æ–¥—É–º–∞—Ç–∏...",
                "–Ø–∫—â–æ —Ä–æ–∑–≤'—è–∂–µ—à –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –æ—Ç—Ä–∏–º–∞—é —Å–º–∞–∫–æ–ª–∏–∫!"
            ];
            
            const randomThought = catThoughts[Math.floor(Math.random() * catThoughts.length)];
            document.getElementById('catThoughtText').textContent = randomThought;
        }
        
        function checkCatGameAnswer() {
            // –Ø–∫—â–æ –∞–Ω—ñ–º–∞—Ü—ñ—è —â–µ —Ç—Ä–∏–≤–∞—î, —ñ–≥–Ω–æ—Ä—É—î–º–æ –∫–ª—ñ–∫
            if (catGameData.isAnimating) return;
            
            const userAnswer = parseInt(document.getElementById('catGameInput').value);
            const correctAnswer = catGameData.currentProblem.answer;
            const feedback = document.getElementById('catGameFeedback');
            
            if (isNaN(userAnswer) || document.getElementById('catGameInput').value === '') {
                feedback.textContent = '–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å —á–∏—Å–ª–æ–≤—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å';
                feedback.className = 'feedback incorrect';
                return;
            }
            
            const isCorrect = userAnswer === correctAnswer;
            
            // –í—ñ–¥—Å—Ç–µ–∂—É—î–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å —É –≥—Ä—ñ
            trackAction('cat_game_answer', {
                problem: `${catGameData.currentProblem.a} √ó ${catGameData.currentProblem.b}`,
                userAnswer,
                correctAnswer,
                isCorrect
            });
            
            if (isCorrect) {
                // –ü—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å
                feedback.textContent = 'üéâ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! –ö–æ—Ç–∏–∫ —Ä–∞–¥—ñ—î!';
                feedback.className = 'feedback correct';
                
                // –ó–±—ñ–ª—å—à—É—î–º–æ —Ä–∞—Ö—É–Ω–æ–∫
                catGameData.score++;
                document.getElementById('catGameScore').textContent = '–°–º–∞–∫–æ–ª–∏–∫–∏: ' + catGameData.score;
                
                // –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                if (!stats.gameScores) stats.gameScores = {};
                stats.gameScores.catGame = Math.max(catGameData.score, stats.gameScores.catGame || 0);
                saveStats();
                
                // –ü–æ–∫–∞–∑—É—î–º–æ –∞–Ω—ñ–º–∞—Ü—ñ—é –≥–æ–¥—É–≤–∞–Ω–Ω—è –∫–æ—Ç–∏–∫–∞
                feedCat();
                
                // –û–Ω–æ–≤–ª—é—î–º–æ –¥—É–º–∫–∏ –∫–æ—Ç–∏–∫–∞
                const catThoughts = [
                    "–ú—è—É! –î—è–∫—É—é –∑–∞ —Å–º–∞–∫–æ–ª–∏–∫!",
                    "–ú–º–º–º... –°–º–∞—á–Ω–æ!",
                    "–ù—è–≤! –©–µ —Ö–æ—á—É!",
                    "–ú—É—Ä—Ä—Ä—Ä! –ß—É–¥–æ–≤–æ!"
                ];
                
                const randomThought = catThoughts[Math.floor(Math.random() * catThoughts.length)];
                document.getElementById('catThoughtText').textContent = randomThought;
                
                // –ß–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥–∏ –≥–µ–Ω–µ—Ä—É—î–º–æ –Ω–æ–≤–µ –ø–∏—Ç–∞–Ω–Ω—è
                setTimeout(() => {
                    document.getElementById('catGameInput').value = '';
                    document.getElementById('catGameFeedback').textContent = '';
                    generateCatGameQuestion();
                    document.getElementById('catGameInput').focus();
                }, 2000);
            } else {
                // –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å
                feedback.textContent = `–ù–µ –∑–æ–≤—Å—ñ–º —Ç–∞–∫. –ü—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å: ${correctAnswer}`;
                feedback.className = 'feedback incorrect';
                
                // –û–Ω–æ–≤–ª—é—î–º–æ –¥—É–º–∫–∏ –∫–æ—Ç–∏–∫–∞
                const catThoughts = [
                    "–ú—è—É... –ó–¥–∞—î—Ç—å—Å—è, —Ü–µ –Ω–µ —Ç–∞–∫",
                    "–ù—è–≤? –°–ø—Ä–æ–±—É–π —â–µ —Ä–∞–∑",
                    "–ú—è—É-–º—è—É... –Ø –≤—Å–µ —â–µ –≥–æ–ª–æ–¥–Ω–∏–π",
                    "–ú—É—Ä—Ä... –Ø –≤—ñ—Ä—é –≤ —Ç–µ–±–µ!"
                ];
                
                const randomThought = catThoughts[Math.floor(Math.random() * catThoughts.length)];
                document.getElementById('catThoughtText').textContent = randomThought;
                
                // –ß–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥–∏ –≥–µ–Ω–µ—Ä—É—î–º–æ –Ω–æ–≤–µ –ø–∏—Ç–∞–Ω–Ω—è
                setTimeout(() => {
                    document.getElementById('catGameInput').value = '';
                    document.getElementById('catGameFeedback').textContent = '';
                    generateCatGameQuestion();
                    document.getElementById('catGameInput').focus();
                }, 2000);
            }
            
            // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è
            checkAchievements();
        }
        
        function feedCat() {
            catGameData.isAnimating = true;
            
            // –ü–æ–∫–∞–∑—É—î–º–æ —ó–∂—É
            const catFood = document.getElementById('catFood');
            catFood.style.display = 'block';
            
            // –ê–Ω—ñ–º–∞—Ü—ñ—è —Ä—É—Ö—É —ó–∂—ñ –¥–æ –∫–æ—Ç–∏–∫–∞
            catFood.style.transition = 'all 1s ease';
            catFood.style.right = '80px';
            catFood.style.bottom = '80px';
            
            // –ü—Ä–æ–≥—Ä–∞—î–º–æ –∑–≤—É–∫ —É—Å–ø—ñ—Ö—É
            try {
                playSuccessSound();
            } catch(e) {
                console.log('Audio not supported');
            }
            
            // –ê–Ω—ñ–º–∞—Ü—ñ—è "—ó–¥—ñ–Ω–Ω—è"
            setTimeout(() => {
                catFood.style.display = 'none';
                catFood.style.right = '20px';
                catFood.style.bottom = '20px';
                
                // –ê–Ω—ñ–º—É—î–º–æ –∫–æ—Ç–∏–∫–∞
                const catCharacter = document.getElementById('catGameCat');
                catCharacter.classList.add('cat-bounce');
                
                setTimeout(() => {
                    catCharacter.classList.remove('cat-bounce');
                    catGameData.isAnimating = false;
                }, 500);
            }, 1000);
        }
        
        function endCatGame() {
            clearInterval(catGameData.interval);
            catGameData.interval = null;
            
            document.getElementById('catGameProblem').textContent = `–ì—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –ö–æ—Ç–∏–∫ –æ—Ç—Ä–∏–º–∞–≤ ${catGameData.score} —Å–º–∞–∫–æ–ª–∏–∫—ñ–≤!`;
            document.getElementById('catGameInput').disabled = true;
            
            // –í—ñ–¥—Å—Ç–µ–∂—É—î–º–æ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –≥—Ä–∏
            trackAction('cat_game_end', { score: catGameData.score });
            
            // –û–Ω–æ–≤–ª—é—î–º–æ –¥—É–º–∫–∏ –∫–æ—Ç–∏–∫–∞
            if (catGameData.score > 5) {
                document.getElementById('catThoughtText').textContent = "–ú—É—Ä—Ä—Ä—Ä! –Ø –Ω–∞—ó–≤—Å—è —ñ –¥—É–∂–µ –∑–∞–¥–æ–≤–æ–ª–µ–Ω–∏–π!";
            } else if (catGameData.score > 0) {
                document.getElementById('catThoughtText').textContent = "–ú—è—É! –î—è–∫—É—é –∑–∞ —Å–º–∞–∫–æ–ª–∏–∫–∏!";
            } else {
                document.getElementById('catThoughtText').textContent = "–ú—è—É... –Ø –≤—Å–µ —â–µ –≥–æ–ª–æ–¥–Ω–∏–π...";
            }
            
            // –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            if (!stats.gameScores) stats.gameScores = {};
            stats.gameScores.catGame = Math.max(catGameData.score, stats.gameScores.catGame || 0);
            saveStats();
            checkAchievements();
        }
        
        // –î–æ–ø–æ–º—ñ–∂–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–µ—Ä–µ–º—ñ—à—É–≤–∞–Ω–Ω—è –º–∞—Å–∏–≤—É
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
    </script>
</body>
</html>